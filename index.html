<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizon Employment Agency Online Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body, div, span, h2, h3, h4, h5, h6, p, a, button, input, select, textarea, label, li {
            font-size: 18px !important; line-height: 1.6; font-family: 'Noto Sans', sans-serif;
        }
        .font-large { font-size: 21px !important; }
        .main-title { font-size: 24px !important; font-weight: bold; color: #1e40af; text-align: center; margin-bottom: 20px; }
        .question-block { margin-bottom: 25px; display: flex; flex-direction: column; border-bottom: 1px solid #e5e7eb; padding-bottom: 15px; }
        .question-label { font-weight: bold; margin-bottom: 10px; color: #1f2937; display: block; }
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; }
        .checkbox-option { display: flex; align-items: flex-start; gap: 10px; cursor: pointer; }
        input[type="text"], input[type="number"], input[type="date"], textarea, select { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; margin-top: 5px; box-sizing: border-box; }
        textarea.expandable { resize: vertical; min-height: 80px; }
        input[type="checkbox"], input[type="radio"] { width: 20px; height: 20px; transform: scale(1.2); margin-right: 8px; margin-top: 4px; flex-shrink: 0; }
        .btn-primary { background-color: #2563eb; color: white; padding: 15px; border-radius: 10px; width: 100%; border: none; cursor: pointer; font-weight: bold; text-align: center; margin-top: 20px; transition: background 0.3s; }
        .btn-primary:hover { background-color: #1d4ed8; }
        .btn-submit { background-color: #16a34a; }
        .btn-submit:hover { background-color: #15803d; }
        .btn-prev { background-color: #6b7280; margin-top: 20px; }
        .btn-prev:hover { background-color: #4b5563; }
        .lang-switcher { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        .lang-btn { padding: 10px 20px; border: 1px solid #2563eb; border-radius: 20px; background: white; color: #2563eb; cursor: pointer; font-weight: bold; font-size: 21px !important; }
        .lang-btn.active { background: #2563eb; color: white; }
        .alert-box { background-color: #fee2e2; color: #991b1b; padding: 10px; border-radius: 8px; margin-top: 5px; font-weight: bold; font-size: 16px !important; }
        
        /* Validation Styles */
        .error-msg { background-color: #fee2e2; color: #991b1b; padding: 5px 10px; border-radius: 5px; margin-top: 5px; font-weight: bold; font-size: 16px !important; display: none; }
        .error-msg.visible { display: block; }
        .input-error { border: 2px solid #ef4444 !important; background-color: #fef2f2; }

        .highlight-header { background-color: #fee2e2; color: #991b1b !important; padding: 10px; border-radius: 8px; }
        .member-label-highlight { background-color: #fee2e2; color: #991b1b; padding: 2px 6px; border-radius: 4px; }
        .hidden { display: none !important; }
        .app-container { max-width: 800px; margin: 0 auto; background: white; min-height: 100vh; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        body { background-color: #f3f4f6; }
        .nav-buttons { display: flex; gap: 10px; width: 100%; margin-top: 20px; }
        .nav-buttons button { flex: 1; margin-top: 0; }
        .msg-text p { margin-bottom: 15px; text-align: justify; }
    </style>
</head>
<body>

<div class="app-container">

    <!-- WELCOME PAGE -->
    <div id="pageWelcome" class="page-section">
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="setLanguage('en')">üáµüá≠ English</button>
            <button class="lang-btn" onclick="setLanguage('id')">üáÆüá© Indonesian</button>
        </div>
        <h1 class="main-title" id="welcomeTitle">Online Registration of Horizon Employment Agency</h1>
        
        <div class="question-block">
            <label class="question-label" data-i18n="seeker_nat_q">Job Seeker's Nationality?</label>
            <div class="checkbox-group" id="welcome_nat_group" onfocusout="validateGroup(this)">
                <label class="checkbox-option"><input type="radio" name="seeker_nationality" value="Filipino"> <span data-i18n="nat_filipino">Filipino</span></label>
                <label class="checkbox-option"><input type="radio" name="seeker_nationality" value="Indonesian"> <span data-i18n="nat_indonesian">Indonesian</span></label>
                <label class="checkbox-option"><input type="radio" name="seeker_nationality" value="Other"> <span data-i18n="nat_other">Other</span></label>
            </div>
            <div class="error-msg" data-i18n="error_msg">Answer This Question</div>
        </div>

        <div class="question-block">
            <label class="question-label" data-i18n="apply_q">What Do You Want to Apply?</label>
            <div class="checkbox-group" id="welcome_apply_group" onfocusout="validateGroup(this)">
                <label class="checkbox-option"><input type="radio" name="apply_for" value="Domestic Helper"> <span data-i18n="apply_helper">Apply as domestic helper</span></label>
                <label class="checkbox-option"><input type="radio" name="apply_for" value="Driver"> <span data-i18n="apply_driver">Apply as Hong Kong driver</span></label>
            </div>
            <div class="error-msg" data-i18n="error_msg">Answer This Question</div>
        </div>

        <div class="question-block">
            <label class="question-label" data-i18n="skills_q">Your Special Skills?</label>
            <div class="checkbox-group" id="welcome_skills_group" onfocusout="validateGroup(this)">
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Nurse"> <span data-i18n="skill_nurse">Nurse experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Teacher"> <span data-i18n="skill_teacher">Teacher experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Elderly Home"> <span data-i18n="skill_elderly_home">Elderly home experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Hotel"> <span data-i18n="skill_hotel">Hotel experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Restaurant"> <span data-i18n="skill_restaurant">Restaurant cooking experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Gardening"> <span data-i18n="skill_gardening">Gardening experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="Carpentry"> <span data-i18n="skill_carpentry">Carpentry experience</span></label>
                <label class="checkbox-option"><input type="checkbox" name="skills" value="None"> <span data-i18n="skill_none">None of the above</span></label>
                
                <label class="checkbox-option flex-col !items-start">
                    <div class="flex items-center">
                        <input type="checkbox" name="skills" value="Other" onchange="toggleInput('skill_other_input', this.checked)"> 
                        <span data-i18n="skill_other">Other experience</span>
                    </div>
                    <input type="text" id="skill_other_input" class="hidden w-full p-1 border rounded mt-2" placeholder="Fill-in other experience" onblur="validateField(this)">
                    <div class="error-msg" data-i18n="error_msg">Answer This Question</div>
                </label>
            </div>
            <div class="error-msg" data-i18n="error_msg">Answer This Question</div>
        </div>

        <button class="btn-primary" onclick="handleWelcomeNext()" data-i18n="btn_welcome_next">I want to find a new employer. I am registering my information now</button>
        <div class="text-center text-gray-400 mt-4 text-sm">V1.64</div>
    </div>

    <!-- PAGE 1 -->
    <div id="page1" class="page-section hidden">
        <h2 class="text-xl font-bold mb-5 border-b-2 border-blue-500 pb-2" data-i18n="basic_info_title">Domestic Helpers Basic Information</h2>
        
        <div class="question-block"><label class="question-label" data-i18n="gender_q">Helper Gender?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="gender" value="Female" onclick="singleSelect(this, 'gender')"> <span data-i18n="female">Female</span></label><label class="checkbox-option"><input type="checkbox" name="gender" value="Male" onclick="singleSelect(this, 'gender')"> <span data-i18n="male">Male</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="fullname_q">Helper Full Name?</label><input type="text" id="fullName" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="where_now_q">Where Are You Now?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="location" value="Hong Kong" onclick="singleSelect(this, 'location'); toggleHKStatus(true)"> <span data-i18n="loc_hk">Now in Hong Kong</span></label><label class="checkbox-option"><input type="checkbox" name="location" value="Philippines" onclick="singleSelect(this, 'location'); toggleHKStatus(false)"> <span data-i18n="loc_ph">Now in Philippines</span></label><label class="checkbox-option"><input type="checkbox" name="location" value="Indonesia" onclick="singleSelect(this, 'location'); toggleHKStatus(false)"> <span data-i18n="loc_id">Now in Indonesia</span></label><label class="checkbox-option"><input type="checkbox" name="location" value="Other" onclick="singleSelect(this, 'location'); toggleHKStatus(false)"> <span data-i18n="loc_other">Now in other Country</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="nationality_q">Helper Nationality?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="nationality" value="Filipino" onclick="singleSelect(this, 'nationality'); toggleInput('nat_other_input', false)"> <span data-i18n="nat_filipino">Filipino</span></label><label class="checkbox-option"><input type="checkbox" name="nationality" value="Indonesian" onclick="singleSelect(this, 'nationality'); toggleInput('nat_other_input', false)"> <span data-i18n="nat_indonesian">Indonesian</span></label><label class="checkbox-option"><input type="checkbox" name="nationality" value="Other" onclick="singleSelect(this, 'nationality'); toggleInput('nat_other_input', true)"> <span data-i18n="nat_other_opt">Other Nationality</span></label><input type="text" id="nat_other_input" class="hidden" placeholder="Fill-in nationality" onblur="validateField(this)"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div id="hk_status_container" class="hidden">
            <div class="question-block"><label class="question-label" data-i18n="hk_status_q">HK Contract Status?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Finish contract" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_finish">Finish contract</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Employer terminated me" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_terminated">Employer terminated me already</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Breached contract" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_breached">I breached contract already</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Break contract" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_break">I will break contract if I find new employer</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Employer passed away" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_passed">Current employer passed away</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Employer relocation" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_relocation">Current employer is relocating</span></label><label class="checkbox-option"><input type="checkbox" name="hk_contract" value="Financial problems" onclick="singleSelect(this, 'hk_contract')"> <span data-i18n="hk_financial">Current employer has financial problems</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
            <div class="question-block"><label class="question-label" data-i18n="finish_date_q">Finish Contract Date OR Last Working Date?</label><input type="text" id="finishContractDate" placeholder="dd-mm-yyyy" onfocus="(this.type='date')" onblur="(this.type='text')" onchange="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        </div>

        <div class="question-block"><label class="question-label" data-i18n="worked_hk_q">Have You Worked in Hong Kong Before?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="worked_hk" value="Yes" onclick="singleSelect(this, 'worked_hk')"> <span data-i18n="yes_worked_hk">Yes, worked in HK before</span></label><label class="checkbox-option"><input type="checkbox" name="worked_hk" value="No" onclick="singleSelect(this, 'worked_hk')"> <span data-i18n="no_first_time">No, 1st time</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="passport_q">Your Passport Expiry Date?</label><input type="text" id="passportExpiry" placeholder="dd-mm-yyyy" onfocus="(this.type='date')" onblur="(this.type='text'); validatePassport()" onchange="validateField(this)"><div id="passportAlert" class="alert-box hidden" data-i18n="passport_alert">Your passport is about to expire, please renew it as soon as possible</div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="dob_q">Your Date of Birth?</label><input type="text" id="dob" placeholder="dd-mm-yyyy" onfocus="(this.type='date')" onblur="(this.type='text')" onchange="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="religion_q">Your Religion?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="religion" value="No religion" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', false)"> <span data-i18n="rel_no">No religion</span></label><label class="checkbox-option"><input type="checkbox" name="religion" value="Catholic" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', false)"> <span data-i18n="rel_catholic">Catholic</span></label><label class="checkbox-option"><input type="checkbox" name="religion" value="Christian" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', false)"> <span data-i18n="rel_christian">Christian</span></label><label class="checkbox-option"><input type="checkbox" name="religion" value="Muslim" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', false)"> <span data-i18n="rel_muslim">Muslim</span></label><label class="checkbox-option"><input type="checkbox" name="religion" value="Buddhist" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', false)"> <span data-i18n="rel_buddhist">Buddhist</span></label><label class="checkbox-option"><input type="checkbox" name="religion" value="Other" onclick="singleSelect(this, 'religion'); toggleInput('rel_other_input', true)"> <span data-i18n="rel_other_opt">Other religion</span></label><input type="text" id="rel_other_input" class="hidden" placeholder="Fill-in religion" onblur="validateField(this)"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="marital_q">Marital Status?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="marital" value="Unmarried" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_unmarried">Unmarried, single</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Unmarried partner" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_partner">Unmarried partner</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Living with partner" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_living">Living with partner</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Married" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_married">Married</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Divorced" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_divorced">Divorced</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Separated" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_separated">Separated</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Single parent" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_singleparent">Single parent</span></label><label class="checkbox-option"><input type="checkbox" name="marital" value="Widowed" onclick="singleSelect(this, 'marital')"> <span data-i18n="mar_widowed">Widowed</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="edu_q">Education?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="education" value="Primary" onclick="singleSelect(this, 'education')"> <span data-i18n="edu_pri">Primary school</span></label><label class="checkbox-option"><input type="checkbox" name="education" value="Secondary" onclick="singleSelect(this, 'education')"> <span data-i18n="edu_sec">Secondary school</span></label><label class="checkbox-option"><input type="checkbox" name="education" value="College" onclick="singleSelect(this, 'education')"> <span data-i18n="edu_col">College</span></label><label class="checkbox-option"><input type="checkbox" name="education" value="Vocational" onclick="singleSelect(this, 'education')"> <span data-i18n="edu_voc">Vocational school</span></label><label class="checkbox-option"><input type="checkbox" name="education" value="University" onclick="singleSelect(this, 'education')"> <span data-i18n="edu_uni">University</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="height_q">Your Height (cm)?</label><input type="number" id="height" onblur="validateField(this); validateHeight()"><div id="heightAlert" class="alert-box hidden" data-i18n="height_alert">Please check if your height was entered incorrectly</div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="weight_q">Your Weight (kg)?</label><input type="number" id="weight" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="spouse_name_q">Your Spouse Name?</label><input type="text" id="spouseName" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="spouse_job_q">Spouse's Job Occupation?</label><input type="text" id="spouseJob" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="siblings_q">Number of Siblings?</label><select id="siblingsCount" class="dynamic-select" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="sibling_pos_q">My Position Among Siblings?</label><select id="siblingPos" class="dynamic-select" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="sons_q">How Many Sons Do You Have?</label><select id="sonsCount" class="dynamic-select" onchange="renderChildAges('sons'); validateField(this)" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="sonsAgesContainer" class="question-block hidden"><label class="question-label" data-i18n="sons_age_q">How Old Are Your All Sons?</label><div id="sonsInputs" class="flex flex-col gap-2"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="daughters_q">How Many Daughters Do You Have?</label><select id="daughtersCount" class="dynamic-select" onchange="renderChildAges('daughters'); validateField(this)" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="daughtersAgesContainer" class="question-block hidden"><label class="question-label" data-i18n="daughters_age_q">How Old Are Your All Daughters?</label><div id="daughtersInputs" class="flex flex-col gap-2"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>

        <div class="question-block"><label class="question-label" data-i18n="whatsapp_q">Your WhatsApp Number? Please Include Country Code</label><div class="flex gap-2"><input type="text" id="whatsapp_code" class="w-1/3" placeholder="Contoh +852" onblur="validateField(this)"><input type="number" id="whatsapp_num" class="w-2/3" placeholder="Contoh 96111003" onblur="validateField(this)"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="homephone_q">Your Home Country Mobile Phone Number? Please Include Country Code</label><div class="flex gap-2"><input type="text" id="homePhone_code" class="w-1/3" placeholder="Contoh +62" onblur="validateField(this)"><input type="number" id="homePhone_num" class="w-2/3" placeholder="Contoh 96111003" onblur="validateField(this)"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="referrer_q">Who Referred You To Our Agency? (if any)</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="radio" name="has_referrer" value="Yes" onclick="toggleReferrer(true)"> <span data-i18n="yes_referrer">Yes, I have referrer</span></label><label class="checkbox-option"><input type="radio" name="has_referrer" value="No" onclick="toggleReferrer(false)"> <span data-i18n="no_referrer">No</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="referrerDetails" class="hidden"><div class="question-block"><label class="question-label" data-i18n="referrer_name_q">Name of Referrer</label><input type="text" id="referrerName" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div><div class="question-block"><label class="question-label" data-i18n="referrer_phone_q">Referrer‚Äôs WhatsApp Number? Please Include Country Code</label><div class="flex gap-2"><input type="text" id="referrerPhone_code" class="w-1/3" placeholder="Contoh +63" onblur="validateField(this)"><input type="number" id="referrerPhone_num" class="w-2/3" placeholder="Contoh 96111003" onblur="validateField(this)"></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div></div>
        <div class="question-block"><label class="question-label" data-i18n="address_q">Your Home Address? (Only Write Province, State, City)</label><textarea id="address" class="expandable" rows="2" onblur="validateField(this)"></textarea><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>

        <div class="nav-buttons">
            <button class="btn-primary btn-prev" onclick="goToPage('pageWelcome')" data-i18n="btn_prev">Previous Page</button>
            <button class="btn-primary" onclick="nextPage(1)" data-i18n="btn_next">Save And Next Page</button>
        </div>
    </div>

    <!-- PAGE 2 -->
    <div id="page2" class="page-section hidden">
        <h2 class="text-xl font-bold mb-5 border-b-2 border-blue-500 pb-2" data-i18n="skills_title">Skills Information</h2>
        <!-- Langs -->
        <div class="question-block"><label class="question-label" data-i18n="cantonese_q">Your Cantonese Language?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="cantonese" value="Learning" onclick="singleSelect(this, 'cantonese')"> <span data-i18n="lang_learning">Learning</span></label><label class="checkbox-option"><input type="checkbox" name="cantonese" value="Average" onclick="singleSelect(this, 'cantonese')"> <span data-i18n="lang_average">Average</span></label><label class="checkbox-option"><input type="checkbox" name="cantonese" value="Good" onclick="singleSelect(this, 'cantonese')"> <span data-i18n="lang_good">Good</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="english_q">Your English Language?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="english" value="Learning" onclick="singleSelect(this, 'english')"> <span data-i18n="lang_learning">Learning</span></label><label class="checkbox-option"><input type="checkbox" name="english" value="Average" onclick="singleSelect(this, 'english')"> <span data-i18n="lang_average">Average</span></label><label class="checkbox-option"><input type="checkbox" name="english" value="Good" onclick="singleSelect(this, 'english')"> <span data-i18n="lang_good">Good</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div class="question-block"><label class="question-label" data-i18n="mandarin_q">Your Mandarin Language?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="mandarin" value="Learning" onclick="singleSelect(this, 'mandarin')"> <span data-i18n="lang_learning">Learning</span></label><label class="checkbox-option"><input type="checkbox" name="mandarin" value="Average" onclick="singleSelect(this, 'mandarin')"> <span data-i18n="lang_average">Average</span></label><label class="checkbox-option"><input type="checkbox" name="mandarin" value="Good" onclick="singleSelect(this, 'mandarin')"> <span data-i18n="lang_good">Good</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        
        <div class="question-block"><label class="question-label" data-i18n="hk_years_q">How Many Years Have You Worked in Hong Kong? (Only Domestic Helper Experience)</label><select id="hkExperienceYears" class="dynamic-select" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <!-- Country Exp -->
        <div id="otherCountryExpContainer"></div>
        <!-- Skills -->
        <div id="skillsContainer"></div>

        <div class="nav-buttons">
            <button class="btn-primary btn-prev" onclick="goToPage('page1')" data-i18n="btn_prev">Previous Page</button>
            <button class="btn-primary" onclick="nextPage(2)" data-i18n="btn_next">Save And Next Page</button>
        </div>
    </div>

    <!-- WORK PAGES -->
    <div id="workPagesContainer"></div>

    <!-- FINAL PAGE -->
    <div id="pageFinal" class="page-section hidden">
        <h2 class="text-xl font-bold mb-5 border-b-2 border-blue-500 pb-2" data-i18n="other_q_title">Other Question</h2>
        <div id="finalQuestionsContainer"></div>
        <div class="question-block"><label class="question-label" data-i18n="visa_q">When You Get Your New Visa, Can You Start Working First?</label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="visaStart" value="Yes" onclick="singleSelect(this, 'visaStart'); toggleVisaQ(true)"> <span data-i18n="visa_yes">Yes, I can start work first</span></label><label class="checkbox-option"><input type="checkbox" name="visaStart" value="No" onclick="singleSelect(this, 'visaStart'); toggleVisaQ(false)"> <span data-i18n="visa_no">No, I will go home first</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="vacationDate" class="question-block hidden"><label class="question-label" data-i18n="vacation_q">When Will You Go Home For Vacation?</label><select id="vacationMonth" class="dynamic-select" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="stayHomeDuration" class="question-block hidden"><label class="question-label" data-i18n="stay_home_q">How Long Will You Stay Home, Then You Back to HK to Work?</label><select id="homeWeeks" class="dynamic-select" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>
        <div id="yesNoContainer"></div>
        
        <div class="nav-buttons">
            <button class="btn-primary btn-prev" onclick="goBackFromFinal()" data-i18n="btn_prev">Previous Page</button>
            <button class="btn-primary btn-submit" onclick="submitRegistration()" data-i18n="btn_submit">Submit Registration</button>
        </div>
    </div>
    
    <!-- OVERSEAS MESSAGE PAGE -->
    <div id="pageOverseasMsg" class="page-section hidden">
        <div class="msg-text p-4 bg-blue-50 rounded border border-blue-200">
            <h2 class="text-xl font-bold mb-4 highlight-header" data-i18n="os_msg_title">Below message for all Overseas helpers and applicants:</h2>
            <div data-i18n="os_msg_content"></div>
            <button class="btn-primary mt-6" onclick="handleOverseasNext()" data-i18n="btn_understand">Understand and Next Page</button>
        </div>
    </div>

    <!-- SUCCESS -->
    <div id="pageSuccess" class="page-section hidden text-center">
        <h2 class="text-2xl font-bold text-green-600 mb-5" id="successTitle">Registration Submitted!</h2>
        <p class="mb-5" id="successMsg">You have successfully submitted your registration.</p>
        <div class="bg-yellow-100 p-5 rounded-lg border border-yellow-300">
            <p class="font-bold mb-3" id="photoMsg"></p>
            <a href="https://wa.me/85296111003" class="inline-block bg-green-500 text-white p-3 rounded-lg font-bold hover:bg-green-600"><i class="fab fa-whatsapp"></i> <span id="whatsappBtnText">Send Photo on WhatsApp</span></a>
            <p class="mt-3 font-bold text-gray-700" id="agencyWaText">Our agency WhatsApp is (+852) 96111003</p>
        </div>
    </div>
</div>

<script>
    // --- 1. GLOBAL VARIABLES ---
    var MAX_JOBS = 5; 
    var ENABLE_VALIDATION = true; // VALIDATION ENABLED
    var currentLang = 'en';
    var targetSheetName = 'Phil'; 
    var indoMonths = ['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
    var engMonths = ['January','February','March','April','May','June','July','August','September','October','November','December'];

    // --- 2. DICTIONARY ---
    var dict = {
        // ... Same dict content ...
        en: {
            title_text: "Online Registration of Horizon Employment Agency", error_msg: "Answer This Question",
            seeker_nat_q: "Job Seeker's Nationality?", btn_welcome_next: "I want to find a new employer. I am registering my information now",
            apply_q: "What Do You Want to Apply?", apply_helper: "Apply as domestic helper", apply_driver: "Apply as Hong Kong driver",
            skills_q: "Your Special Skills?", skill_nurse: "Nurse experience", skill_teacher: "Teacher experience", skill_elderly_home: "Elderly home experience", skill_hotel: "Hotel experience", skill_gardening: "Gardening experience", skill_carpentry: "Carpentry experience", skill_none: "None of the above", skill_other: "Other experience", ph_skill_other: "Fill-in other experience", skill_restaurant: "Restaurant cooking experience",
            basic_info_title: "Domestic Helpers Basic Information", gender_q: "Helper Gender?", female: "Female", male: "Male", fullname_q: "Helper Full Name?", where_now_q: "Where Are You Now?", loc_hk: "Now in Hong Kong", loc_ph: "Now in Philippines", loc_id: "Now in Indonesia", loc_other: "Now in other Country",
            nationality_q: "Helper Nationality?", nat_filipino: "Filipino", nat_indonesian: "Indonesian", nat_other: "Other", nat_other_opt: "Other Nationality", ph_nat_other: "Fill-in nationality",
            hk_status_q: "HK Contract Status?", hk_finish: "Finish contract", hk_terminated: "Employer terminated me already", hk_breached: "I breached contract already", hk_break: "I will break contract if I find new employer", hk_passed: "Current employer passed away", hk_relocation: "Current employer is relocating", hk_financial: "Current employer has financial problems",
            finish_date_q: "Finish Contract Date OR Last Working Date?", worked_hk_q: "Have You Worked in Hong Kong Before?", yes_worked_hk: "Yes, worked in HK before", no_first_time: "No, 1st time",
            passport_q: "Your Passport Expiry Date?", passport_alert: "Your passport is about to expire, please renew it as soon as possible", dob_q: "Your Date of Birth?",
            religion_q: "Your Religion?", rel_no: "No religion", rel_catholic: "Catholic", rel_christian: "Christian", rel_muslim: "Muslim", rel_buddhist: "Buddhist", rel_other: "Other", rel_other_opt: "Other religion", ph_rel_other: "Fill-in religion",
            marital_q: "Marital Status?", mar_unmarried: "Unmarried, single", mar_partner: "Unmarried partner", mar_living: "Living with partner", mar_married: "Married", mar_divorced: "Divorced", mar_separated: "Separated", mar_singleparent: "Single parent", mar_widowed: "Widowed",
            edu_q: "Education?", edu_pri: "Primary school", edu_sec: "Secondary school", edu_col: "College", edu_voc: "Vocational school", edu_uni: "Universitas",
            height_q: "Your Height (cm)?", height_alert: "Please check if your height was entered incorrectly", weight_q: "Your Weight (kg)?", spouse_name_q: "Your Spouse Name?", spouse_job_q: "Spouse's Job Occupation?",
            siblings_q: "Number of Siblings?", sibling_pos_q: "My Position Among Siblings?", sons_q: "How Many Sons Do You Have?", sons_age_q: "How Old Are Your All Sons?", opt_noson: "No son", daughters_q: "How Many Daughters Do You Have?", daughters_age_q: "How Old Are Your All Daughters?", opt_nodaughter: "No daughter",
            whatsapp_q: "Your WhatsApp Number? Please Include Country Code", homephone_q: "Your Home Country Mobile Phone Number? Please Include Country Code", referrer_q: "Who Referred You To Our Agency? (if any)", yes_referrer: "Yes, I have referrer", no_referrer: "No", referrer_name_q: "Name of Referrer", referrer_phone_q: "Referrer‚Äôs WhatsApp Number? Please Include Country Code", address_q: "Your Home Address? (Only Write Province, State, City)",
            btn_next: "Save And Next Page", btn_prev: "Previous Page", btn_submit: "Submit Registration",
            skills_title: "Skills Information", cantonese_q: "Your Cantonese Language?", english_q: "Your English Language?", mandarin_q: "Your Mandarin Language?", lang_learning: "Learning", lang_average: "Average", lang_good: "Good", hk_years_q: "How Many Years Have You Worked in Hong Kong? (Only Domestic Helper Experience)",
            skill_newborn: "Are You Willing to Take Care of Newborn Babies?", skill_children: "Are You Willing to Take Care of Children?", skill_elderly: "Are You Willing to Take Care of Elderly?", skill_disabled: "Are You Willing to Take Care of Disabled Persons?", skill_pets: "Are You Willing to Take Care of Pets?", skill_cook: "Are You Willing to Cook?", yes_willing: "Yes, willing", no: "No",
            cnt_sg: "How Many Years Have You Worked in Singapore? (Only Domestic Helper Experience)", cnt_tw: "How Many Years Have You Worked in Taiwan? (Only Domestic Helper Experience)", cnt_my: "How Many Years Have You Worked in Malaysia? (Only Domestic Helper Experience)", cnt_me: "How Many Years Have You Worked in Middle East? (Only Domestic Helper Experience)", cnt_sa: "How Many Years Have You Worked in Saudi Arabia? (Only Domestic Helper Experience)", cnt_id: "How Many Years Have You Worked in Indonesia? (Only Domestic Helper Experience)", cnt_ph: "How Many Years Have You Worked in Philippines? (Only Domestic Helper Experience)", cnt_other: "How Many Years Have You Worked in other Country? (Only Domestic Helper Experience)", ph_cnt_other: "Fill-in other Country",
            cnt_other_q_check: "How Many Years Have You Worked in other Country? (Only Domestic Helper Experience)", cnt_yes_worked: "Yes, I have worked in other country", cnt_no_worked: "No other country",
            work_latest_title: "Latest Domestic Helper Work Experience (Including Working in Hong Kong, in Philippines, in Indonesia, in Other Countries, Only Domestic Helper Experience)", work_other_title: "Other Domestic Helper Experience", work_country: "Country of Employment? (If Hong Kong, Write Location, e.g. Causeway Bay)", work_emp_nat: "Employer's Nationality?", 
            opt_emp_nat_local: "Local people", opt_emp_nat_foreigner: "Foreigner", opt_emp_nat_chinese: "Chinese", opt_emp_nat_hk: "Hong Kong people", opt_emp_nat_asian: "Asian",
            work_start: "In This Employer, Start Work Year And Start Work Month?", work_end: "In This Employer, End Work Year And End Work Month?", work_size: "Employer‚Äôs House Size? (e.g. 1000 square feet)", work_fam_count: "Number of Employer Family Members? (Living in The Same Home)", work_fam_age: "Age of Employer Family Members", work_helpers: "Number of Helpers?", work_status: "Contract Status?", work_reason: "Reason for Leaving? (Clear And True Reason)",
            work_dis_q: "In This Employer, Did You Take Care of Disabled Person?", dis_no: "No", dis_bed: "Bedridden care", dis_dis: "Disability care", dis_tra: "Tracheostomy care", dis_wheel: "Wheelchair", dis_walk: "Walking slowly", dis_med: "Medication feeding", dis_bath: "Bathing assistance", dis_stroke: "Stroke", dis_alz: "Alzheimer's disease", dis_park: "Parkinson's disease", dis_other1: "Other disabled person (1)", dis_other2: "Other disabled person (2)", ph_dis_other1: "Fill-in details", ph_dis_other2: "Fill-in details",
            work_pets: "Employer‚Äôs Pets?", pet_no: "No pets", pet_s_dog: "Small dog", pet_m_dog: "Medium dog", pet_b_dog: "Big dog", pet_cat: "Cat", pet_rabbit: "Rabbit", pet_other: "Other pet (1)", pet_other2: "Other pet (2)", pet_other3: "Other pet (3)",
            work_resp: "Job Responsibilities?", resp_car: "Car wash", resp_clean: "House cleaning", resp_wash: "Hand washing clothes", resp_market: "I go to supermarket to buy food", resp_wet_market: "I go to Chinese wet-market to buy food", resp_room: "I sharing room with other", resp_cook_c: "Cook Chinese food", resp_cook_w: "Cook Western food", resp_other: "Other responsibilities (1)", resp_other2: "Other responsibilities (2)", resp_other3: "Other responsibilities (3)",
            work_more_q: "Do You Still Have Other Domestic Helper Work Experience in HK OR in Other Countries OR in Philippines OR in Indonesia? (Only Domestic Helper Experience)?", work_more_yes: "Yes, still have other employer", work_more_no_1: "No, only one employer experience", work_more_no_2: "No, only 2 employer experience", work_more_no_3: "No, only 3 employer experience", work_more_no_4: "No, only 4 employer experience", work_more_no_5: "No, only 5 employer experience", work_status_resigned: "I resigned already", work_status_nocontract: "Not contract and can leave anytime",
            other_q_title: "Other Question", q_like_cooking: "Do You Like Cooking?", q_like_cooking_yes: "Yes, I like", q_learn_yt: "Can You Learn New Dishes by Yourself From YouTube?", q_learn_yt_yes: "Yes, I can", q_confident: "Are You Confident in Your Cooking?", q_confident_yes: "Yes, I am confident", q_sing: "Can You Sing a Song OR Tell a Story to Lull The Child to Sleep?", q_sing_yes: "Yes, I can", q_tutor: "Do You Have Experience Tutoring Children With Their Homework?", q_tutor_yes: "Yes, I have experience", visa_q: "When You Get Your New Visa, Can You Start Working First?", visa_yes: "Yes, I can start work first", visa_no: "No, I will go home first", vacation_q: "When Will You Go Home For Vacation?", stay_home_q: "How Long Will You Stay Home, Then You Back to HK to Work?", q_dog: "Are You Afraid of Dogs?", q_cat: "Are You Afraid of Cats?", q_afraid_yes: "Yes, afraid", q_tattoo: "Do You Have Any Tattoos?", q_tattoo_yes: "Yes, I have", tattoo_msg: "If you have tattoos, please send us the photos later", q_smoke: "Do You Have Smoking OR Drinking Habits?", q_allergy: "Do You Have Any Allergies, illnesses, Diseases, Skin Irritations, Infectious Diseases, or Other Conditions?", q_chronic: "Do You Have Any Chronic illnesses, Require Injections, Take Medication, Need Follow-up Appointments, Diabetes, Heart Disease, or Other Serious illnesses?", q_consent: "Have you read, understood, agreed to, acknowledged, and authorized our Company‚Äôs Personal Information Collection Statement, and do you not object to it?", q_consent_yes: "Yes, I agree", q_fingers: "Are Your Fingers And Toes Normal, No More And No Less?", q_fingers_yes: "Yes, normal", q_fingers_no: "No, I have more or fewer", q_confirm: "I confirm that all of the above information is correct, complete, and true. And I will take full responsibility for any errors or omissions. And I also agree to have the Horizon Employment Agency send and use the above my information to all prospective employers?", q_confirm_yes: "I have read, understand, confirm and agree", q_confirm_no: "No",
            ph_qty: "Enter quantity", ph_pet: "Enter pet", ph_resp: "Enter Responsibilities",
            opt_select: "Select", opt_month: "Month", opt_year: "Year", opt_sibling_suf: "sibling", opt_sibling_pos_pre: "Number", opt_week: "week", opt_weeks: "weeks", opt_emp_nat_local: "Local people", opt_emp_nat_foreigner: "Orang Asing", opt_emp_nat_chinese: "Orang Cina", opt_emp_nat_hk: "Orang Hong Kong", opt_emp_nat_asian: "Orang Asia", opt_only_emp: "1 (Only employer)", opt_emp_plus: "employer +", opt_only_me: "1 (only me)", opt_me_plus: "me +", opt_role_adult: "Adult", opt_role_boy: "Boy", opt_role_girl: "Girl", opt_role_twins: "Twins", opt_role_triplets: "Triplets", opt_role_grandpa: "Grandpa", opt_role_grandma: "Grandma", opt_age_start: "Age when you started (From)", opt_age_leave: "Age when you leave (until)", opt_preg: "Female employer is pregnant", opt_never_hk: "0 (Never been to Hong Kong)", opt_20_years: "0 to 20 years", opt_1_son: "1 son", opt_1_daughter: "1 daughter", opt_1_year: "1 year",
            photo_msg_part1: "Now, please send us your ", photo_msg_highlight: "‚Äúhalf-body‚Äù photo", photo_msg_part2: " by clicking the WhatsApp button below", agency_wa: "Our agency WhatsApp is (+852) 96111003",
            os_msg_title: "Below message for all Overseas helpers and applicants:",
            os_msg_content: "<p class='mb-4'>You pay Zero peso, 0 piso, no salary deduction, you no need to pay any Philippine fees, such as the training fee, medical fee</p><p class='mb-4'>You only need to be responsible for the accommodation and air tickets and transportation go to our Manila agency (in Makati City) for training, medical, other processes and getting your flight from Manila to Hong Kong</p><p class='mb-4'>You need to calculate how much money you need to prepare and you will need to go to Manila agency 2 times, I think usually around 9000 peso, but depending on how far you are from Manila. You pay 9000 peso is for your accommodation and transportation to go to Manila agency 2 times from your hometown</p><p class='mb-4'>If you don't have enough money to pay for transportation, food and accommodation, please start working and prepare the money now. You need to go to the Manila agency 2 times and stay in Manila for a few days each time</p><p class='mb-4'>1st time you go to the Manila agency is when you get hired by our Employer. You go Manila for reporting, do medical and others, stay 6-9 days, after that you can go home to wait Hong Kong visa or you can find a job work in Manila to wait Hong Kong visa</p><p class='mb-4'>After 6-8 weeks, 2nd time go to Manila agency. When all documents is finished, I will tell you, then you go to Manila stay 2-3 days for getting your flight from Manila to Hong Kong</p><p class='mb-4'>The Hong Kong visa application process to come to Hong Kong takes about 2-3 months, so you need to start working from now until you can fly to Hong Kong. Otherwise, you won't have the financial to support your family's living expenses for these few months and cover the costs of air tickets and accommodation for the flight to Manila for processing</p>",
            btn_understand: "Understand and Next Page"
        },
        id: {
            title_text: "Pendaftaran Online Horizon Employment Agency", error_msg: "Jawab Pertanyaan Ini",
            seeker_nat_q: "Kewarganegaraan Pencari Kerja?", btn_welcome_next: "Saya ingin mencari majikan baru. Saya sedang mendaftar sekarang", apply_q: "Ingin melamar apa?", apply_helper: "Melamar sebagai PRT", apply_driver: "Melamar sebagai sopir Hong Kong",
            skills_q: "Keahlian khusus Anda?", skill_nurse: "Pengalaman perawat", skill_teacher: "Pengalaman guru", skill_elderly_home: "Pengalaman panti jompo", skill_hotel: "Pengalaman hotel", skill_gardening: "Pengalaman berkebun", skill_carpentry: "Pengalaman pertukangan", skill_none: "Tidak ada", skill_other: "Pengalaman lainnya", ph_skill_other: "Isi pengalaman lainnya", skill_restaurant: "Pengalaman memasak di restoran",
            basic_info_title: "Informasi Dasar Pekerja Rumah Tangga", gender_q: "Jenis Kelamin?", female: "Wanita", male: "Pria", fullname_q: "Nama Lengkap?", where_now_q: "Dimana Anda Sekarang?", loc_hk: "Sekarang di Hong Kong", loc_ph: "Sekarang di Filipina", loc_id: "Sekarang di Indonesia", loc_other: "Sekarang di Negara Lain",
            nationality_q: "Kewarganegaraan?", nat_filipino: "Filipina", nat_indonesian: "Indonesia", nat_other: "Lainnya", nat_other_opt: "Lainnya Kewarganegaraan", ph_nat_other: "Mengisi kewarganegaraan",
            hk_status_q: "Status Kontrak HK?", hk_finish: "Selesai kontrak", hk_terminated: "Majikan sudah memutus kontrak", hk_breached: "Saya sudah melanggar kontrak", hk_break: "Saya akan memutus kontrak jika mendapat majikan baru", hk_passed: "Majikan saat ini meninggal", hk_relocation: "Majikan pindah negara", hk_financial: "Majikan ada masalah keuangan",
            finish_date_q: "Tanggal Selesai Kontrak ATAU Hari Kerja Terakhir?", worked_hk_q: "Pernah Bekerja di Hong Kong Sebelumnya?", yes_worked_hk: "Ya, pernah bekerja di HK", no_first_time: "Tidak, ini pertama kali",
            passport_q: "Tanggal Habis Masa Berlaku Paspor?", passport_alert: "Paspor Anda akan segera habis masa berlakunya, harap segera diperbarui", dob_q: "Tanggal Lahir Anda?",
            religion_q: "Agama Anda?", rel_no: "Tidak beragama", rel_catholic: "Katolik", rel_christian: "Kristen", rel_muslim: "Muslim", rel_buddhist: "Buddha", rel_other: "Lainnya", rel_other_opt: "Lainnya agama", ph_rel_other: "Mengisi agama",
            marital_q: "Status Pernikahan?", mar_unmarried: "Belum menikah, lajang", mar_partner: "Pasangan belum menikah", mar_living: "Tinggal bersama pasangan", mar_married: "Menikah", mar_divorced: "Cerai hidup", mar_separated: "Pisah ranjang", mar_singleparent: "Orang tua tunggal", mar_widowed: "Janda/Duda",
            edu_q: "Pendidikan?", edu_pri: "SD", edu_sec: "SMP/SMA", edu_col: "Diploma", edu_voc: "Sekolah Kejuruan", edu_uni: "Universitas",
            height_q: "Tinggi Badan (cm)?", height_alert: "Harap periksa apakah tinggi badan Anda salah dimasukkan", weight_q: "Berat Badan (kg)?", spouse_name_q: "Nama Pasangan?", spouse_job_q: "Pekerjaan Pasangan?",
            siblings_q: "Jumlah Saudara?", sibling_pos_q: "Posisi Saya dalam Saudara Kandung?", sons_q: "Berapa Jumlah Anak Laki-laki?", sons_age_q: "Berapa Umur Semua Anak Laki-laki?", opt_noson: "Tidak ada", daughters_q: "Berapa Jumlah Anak Perempuan?", daughters_age_q: "Berapa Umur Semua Anak Perempuan?", opt_nodaughter: "Tidak ada",
            whatsapp_q: "Nomor WhatsApp Anda? Harap Sertakan Kode Negara", homephone_q: "Nomor HP Negara Asal Anda? Harap Sertakan Kode Negara", referrer_q: "Siapa yang Mereferensikan Anda ke Agensi Kami? (jika ada)", yes_referrer: "Ya, saya punya referensi", no_referrer: "Tidak", referrer_name_q: "Nama Referensi", referrer_phone_q: "Nomor WhatsApp Referensi? Harap Sertakan Kode Negara", address_q: "Alamat Rumah Anda? (Tulis Provinsi, Negara Bagian, Kota Saja)",
            btn_next: "Simpan Dan Halaman Berikutnya", btn_prev: "Halaman Sebelumnya", btn_submit: "Simpan Dan Kirim Pendaftaran",
            skills_title: "Informasi Keahlian", cantonese_q: "Bahasa Kantonis Anda?", english_q: "Bahasa Inggris Anda?", mandarin_q: "Bahasa Mandarin Anda?", lang_learning: "Sedang Belajar", lang_average: "Rata-rata", lang_good: "Bagus", hk_years_q: "Berapa Tahun Anda Bekerja di Hong Kong? (Hanya Pengalaman PRT)",
            skill_newborn: "Apakah Anda Bersedia Merawat Bayi Baru Lahir?", skill_children: "Apakah Anda Bersedia Merawat Anak-anak?", skill_elderly: "Apakah Anda Bersedia Merawat Lansia?", skill_disabled: "Apakah Anda Bersedia Merawat Orang Cacat?", skill_pets: "Apakah Anda Bersedia Merawat Hewan Peliharaan?", skill_cook: "Apakah Anda Bersedia Memasak?", yes_willing: "Ya, bersedia", no: "Tidak",
            cnt_sg: "Berapa Tahun Anda Bekerja di Singapura? (Hanya Pengalaman PRT)", cnt_tw: "Berapa Tahun Anda Bekerja di Taiwan? (Hanya Pengalaman PRT)", cnt_my: "Berapa Tahun Anda Bekerja di Malaysia? (Hanya Pengalaman PRT)", cnt_me: "Berapa Tahun Anda Bekerja di Timur Tengah? (Hanya Pengalaman PRT)", cnt_sa: "Berapa Tahun Anda Bekerja di Arab Saudi? (Hanya Pengalaman PRT)", cnt_id: "Berapa Tahun Anda Bekerja di Indonesia? (Hanya Pengalaman PRT)", cnt_ph: "Berapa Tahun Anda Bekerja di Filipina? (Hanya Pengalaman PRT)", cnt_other: "Berapa Tahun Anda Bekerja di negara-negara lain? (Hanya Pengalaman PRT)", ph_cnt_other: "Isi Negara Lain",
            cnt_other_q_check: "Berapa Tahun Anda Bekerja di negara-negara lain? (Hanya Pengalaman PRT)", cnt_yes_worked: "Ya, saya pernah bekerja di negara lain", cnt_no_worked: "Tidak ada negara lain",
            work_latest_title: "PRT Pengalaman Kerja Terakhir (Termasuk Hong Kong, Filipina, Indonesia, Negara Lain, hanya PRT)", work_other_title: "Pengalaman PRT Lainnya", work_country: "Negara Tempat Bekerja? (Jika Hong Kong, Tulis Lokasi, Misalnya Causeway Bay)", work_emp_nat: "Kewarganegaraan Majikan?", work_start: "Di Majikan Ini, Tahun Mulai Kerja Dan Bulan Mulai Kerja?", work_end: "Di Majikan Ini, Tahun Selesai Kerja Dan Bulan Selesai Kerja?", work_size: "Ukuran Rumah Majikan? (contoh 1000 kaki persegi)", work_fam_count: "Jumlah Anggota Keluarga Majikan? (Tinggal di Rumah yang Sama)", work_fam_age: "Umur Anggota Keluarga Majikan", work_helpers: "Jumlah Pembantu?", work_status: "Status Kontrak?", work_reason: "Alasan Keluar? (Alasan Jelas Dan Benar)",
            work_dis_q: "Di majikan ini, apakah Anda mengurus orang disabilitas?", dis_no: "Tidak", dis_bed: "Perawatan pasien terbaring", dis_dis: "Perawatan disabilitas", dis_tra: "Perawatan trakeostomi", dis_wheel: "Kursi roda", dis_walk: "Berjalan perlahan", dis_med: "Pemberian obat", dis_bath: "Bantuan mandi", dis_stroke: "Stroke", dis_alz: "Alzheimer", dis_park: "Parkinson", dis_other1: "Penyandang disabilitas lainnya (1)", dis_other2: "Penyandang disabilitas lainnya (2)", ph_dis_other1: "Isi detail", ph_dis_other2: "Isi detail",
            work_pets: "Hewan Peliharaan Majikan?", pet_no: "Tidak ada", pet_s_dog: "Anjing kecil", pet_m_dog: "Anjing sedang", pet_b_dog: "Anjing besar", pet_cat: "Kucing", pet_rabbit: "Kelinci", pet_other: "Hewan Lain (1)", pet_other2: "Hewan Lain (2)", pet_other3: "Hewan Lain (3)",
            work_resp: "Tanggung Jawab Pekerjaan?", resp_car: "Cuci mobil", resp_clean: "Bersih-bersih rumah", resp_wash: "Cuci baju tangan", resp_market: "Pergi ke pasar beli makanan", resp_wet_market: "Saya pergi ke pasar basah Cina untuk membeli makanan", resp_room: "Berbagi kamar dengan orang lain", resp_cook_c: "Masak makanan Cina", resp_cook_w: "Masak makanan Barat", resp_other: "Tanggung jawab lainnya (1)", resp_other2: "Tanggung jawab lainnya (2)", resp_other3: "Tanggung jawab lainnya (3)",
            work_more_q: "Apakah Anda Masih Memiliki Pengalaman Kerja PRT Lain di HK, Negara lain, Filipina, Indonesia? (Hanya Pekerjaan PRT)?", work_more_yes: "Ya, masih punya majikan lain", work_more_no_1: "Tidak, hanya 1 pengalaman majikan", work_more_no_2: "Tidak, hanya 2 pengalaman majikan", work_more_no_3: "Tidak, hanya 3 pengalaman majikan", work_more_no_4: "Tidak, hanya 4 pengalaman majikan", work_more_no_5: "Tidak, hanya 5 pengalaman majikan", work_status_resigned: "Saya mengundurkan diri", work_status_nocontract: "Tidak ada kontrak, bisa keluar kapan saja",
            other_q_title: "Pertanyaan Lain", q_like_cooking: "Apakah Anda Suka Memasak?", q_like_cooking_yes: "Ya, saya suka", q_learn_yt: "Bisakah Anda Belajar Masakan Baru Sendiri Dari YouTube?", q_learn_yt_yes: "Ya, saya bisa", q_confident: "Apakah Anda Percaya Diri dengan Masakan Anda?", q_confident_yes: "Ya, saya percaya diri", q_sing: "Bisakah Anda Menyanyikan Lagu ATAU Bercerita untuk Menidurkan Anak?", q_sing_yes: "Ya, saya bisa", q_tutor: "Apakah Anda Punya Pengalaman Mengajari Anak-anak PR Mereka?", q_tutor_yes: "Ya, saya berpengalaman", visa_q: "Saat Anda Mendapatkan Visa Baru, Bisakah Anda Mulai Bekerja Dulu?", visa_yes: "Ya, saya bisa mulai kerja dulu", visa_no: "Tidak, saya pulang dulu", vacation_q: "Kapan Anda Akan Pulang Untuk Liburan?", stay_home_q: "Berapa Lama Anda Akan Tinggal di Rumah, Lalu Kembali ke HK untuk Bekerja?", q_dog: "Apakah Anda Takut Anjing?", q_cat: "Apakah Anda Takut Kucing?", q_afraid_yes: "Ya, takut", q_tattoo: "Apakah Anda Memiliki Tato?", q_tattoo_yes: "Ya, saya punya", tattoo_msg: "Jika Anda memiliki tato, silakan kirim foto-fotonya kepada kami nanti", q_smoke: "Apakah Anda Memiliki Kebiasaan Merokok ATAU Minum Alkohol?", q_allergy: "Apakah Anda Memiliki Alergi, Penyakit, Iritasi Kulit, Penyakit Menular, atau Kondisi Lainnya?", q_chronic: "Apakah Anda Memiliki Penyakit Kronis, Perlu Suntikan, Minum Obat, Perlu Janji Temu Lanjutan, Diabetes, Penyakit Jantung, atau Penyakit Serius Lainnya?", q_consent: "Apakah Anda sudah membaca, memahami, menyetujui, mengakui, dan memberikan wewenang pada Pernyataan Pengumpulan Informasi Pribadi Perusahaan kami, dan Anda tidak keberatan?", q_consent_yes: "Ya, saya setuju", q_fingers: "Apakah jari tangan dan jari kaki Anda normal, tidak lebih dan tidak kurang?", q_fingers_yes: "Ya, normal", q_fingers_no: "Tidak, saya punya lebih atau kurang", q_confirm: "Saya mengonfirmasi bahwa semua informasi di atas benar, lengkap, dan benar. Saya akan bertanggung jawab penuh atas segala kesalahan atau kelalaian. Saya juga setuju agar Horizon Employment Agency mengirimkan dan menggunakan informasi saya di atas kepada semua calon pemberi kerja.", q_confirm_yes: "Saya telah membaca, memahami, mengonfirmasi dan menyetujui", q_confirm_no: "No",
            ph_qty: "Masukkan jumlah", ph_pet: "Mohon sebutkan", ph_resp: "Mohon sebutkan",
            opt_select: "Pilih", opt_month: "Bulan", opt_year: "Tahun", opt_sibling_suf: "saudara", opt_sibling_pos_pre: "Anak pertama", opt_week: "minggu", opt_weeks: "minggu", opt_emp_nat_local: "Orang Lokal", opt_emp_nat_foreigner: "Orang Asing", opt_emp_nat_chinese: "Orang Cina", opt_emp_nat_hk: "Orang Hong Kong", opt_emp_nat_asian: "Orang Asia", opt_only_emp: "Hanya majikan", opt_emp_plus: "Majikan +", opt_only_me: "1 (Saya sendiri)", opt_me_plus: "saya +", opt_role_adult: "Dewasa", opt_role_boy: "Anak Laki-laki", opt_role_girl: "Anak Perempuan", opt_role_twins: "Anak Kembar", opt_role_triplets: "Kembar Tiga", opt_role_grandpa: "Kakek", opt_role_grandma: "Nenek", opt_age_start: "Usia mulai (Dari)", opt_age_leave: "Usia selesai (Sampai)", opt_preg: "Majikan perempuan sedang hamil", opt_never_hk: "0 (Belum pernah ke Hong Kong)", opt_20_years: "0 sampai 20 tahun", opt_1_son: "1 putra", opt_1_daughter: "1 anak perempuan", opt_1_year: "1 tahun",
            photo_msg_part1: "Sekarang, kirim ", photo_msg_highlight: "foto \"setengah badan\"", photo_msg_part2: " Anda dengan klik tombol WhatsApp di bawah", agency_wa: "Agensi kami WhatsApp adalah (+852) 96111003"
        }
    };

    // --- 3. UTILITY FUNCTIONS ---
    function saveLocal() {
        try {
            var data = {};
            var inputs = document.querySelectorAll('input, select, textarea');
            for (var i = 0; i < inputs.length; i++) {
                var el = inputs[i];
                if(el.type === 'checkbox' || el.type === 'radio') {
                    if(el.checked) {
                        if(!data[el.name]) data[el.name] = [];
                        data[el.name].push(el.value);
                    }
                } else if(el.id) {
                    data[el.id] = el.value;
                }
            }
            localStorage.setItem('helperFormData', JSON.stringify(data));
            return data;
        } catch(e) { return {}; }
    }
    
    function restoreLocal() { try { localStorage.removeItem('helperFormData'); } catch(e){} }

    function validateField(input) {
        if(!ENABLE_VALIDATION) return;
        var parent = input.parentElement;
        var errorMsg = input.nextElementSibling;
        if (!errorMsg || !errorMsg.classList.contains('error-msg')) {
             errorMsg = parent ? (parent.querySelector('.error-msg') || parent.parentElement.querySelector('.error-msg')) : null;
        }
        
        // Skip validation if input is hidden
        if(input.offsetParent === null) {
             if(errorMsg) errorMsg.classList.remove('visible');
             input.classList.remove('input-error');
             return;
        }
        
        if(!errorMsg) return;

        if(!input.value || input.value.trim() === '') {
            errorMsg.classList.add('visible');
            input.classList.add('input-error');
        } else {
            errorMsg.classList.remove('visible');
            input.classList.remove('input-error');
        }
    }

    function validateGroup(container) {
        if(!ENABLE_VALIDATION) return;
        if(container.offsetParent === null) return; // Skip hidden
        
        var inputs = container.querySelectorAll('input');
        var checked = false;
        for (var i = 0; i < inputs.length; i++) { if(inputs[i].checked) checked = true; }
        var parent = container.parentElement;
        var errorMsg = parent ? parent.querySelector('.error-msg') : null;
        if(!errorMsg) return;
        
        if(!checked) { errorMsg.classList.add('visible'); } 
        else { errorMsg.classList.remove('visible'); }
    }

    function singleSelect(checkbox, name) {
        var items = document.getElementsByName(name);
        for (var i = 0; i < items.length; i++) {
            if (items[i] !== checkbox) items[i].checked = false;
        }
    }

    function toggleInput(id, show) {
        var el = document.getElementById(id);
        if(el) {
            if(show) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
                el.value = ''; // Clear value
                el.classList.remove('input-error'); // Remove error class
                // Hide error message if exists
                var errorMsg = el.nextElementSibling;
                if (!errorMsg || !errorMsg.classList.contains('error-msg')) {
                     errorMsg = el.parentElement ? (el.parentElement.querySelector('.error-msg') || el.parentElement.parentElement.querySelector('.error-msg')) : null;
                }
                if(errorMsg) errorMsg.classList.remove('visible');
            }
        }
    }

    function toggleHKStatus(isHK) {
        var el = document.getElementById('hk_status_container');
        if(el) {
            if(isHK) el.classList.remove('hidden'); else el.classList.add('hidden');
        }
    }
    
    function toggleReferrer(isYes) {
        var el = document.getElementById('referrerDetails');
        if(el) {
            if(isYes) el.classList.remove('hidden'); else el.classList.add('hidden');
        }
    }

    function toggleOtherCountryInput(isYes) {
        var detailContainer = document.getElementById('cnt_other_details');
        if(detailContainer) {
            if(isYes) detailContainer.classList.remove('hidden');
            else detailContainer.classList.add('hidden');
        }
    }

    function togglePetQty(checkbox, inputId) {
        var inputContainer = document.getElementById(inputId);
        if(!inputContainer) return;
        var petName = checkbox.getAttribute('data-pet');
        
        if(petName === 'No pets') {
            // Logic for No pets (clear others?) - simplified here
        } else {
            if(checkbox.checked) {
                inputContainer.classList.remove('hidden');
            } else {
                inputContainer.classList.add('hidden');
                var inputs = inputContainer.querySelectorAll('input');
                for (var i=0; i<inputs.length; i++) {
                    inputs[i].value = '';
                    inputs[i].classList.remove('input-error');
                }
                // Hide error msg inside container
                var errorMsg = inputContainer.querySelector('.error-msg');
                if(errorMsg) errorMsg.classList.remove('visible');
            }
        }
    }

    function toggleVisaQ(isYes) {
        var v = document.getElementById('vacationDate');
        var s = document.getElementById('stayHomeDuration');
        if(v && s) {
            if(isYes) { v.classList.remove('hidden'); s.classList.add('hidden'); } 
            else { v.classList.add('hidden'); s.classList.remove('hidden'); }
        }
    }

    function toggleTattooAlert(show) {
        var el = document.getElementById('tattooAlert');
        if(el) {
            if(show) el.classList.remove('hidden'); else el.classList.add('hidden');
        }
    }

    function renderChildAges(type) {
        var countEl = document.getElementById(type + 'Count');
        if(!countEl) return;
        var count = parseInt(countEl.value);
        var container = document.getElementById(type + 'AgesContainer');
        var inputContainer = document.getElementById(type + 'Inputs');
        if(!inputContainer || !container) return;
        inputContainer.innerHTML = '';
        if (count > 0) {
            container.classList.remove('hidden');
            for(var i=1; i<=count; i++) {
                var ph = type === 'sons' ? (currentLang === 'id' ? "Umur anak laki-laki" : "Age of son") : (currentLang === 'id' ? "Umur anak perempuan" : "Age of daughter");
                ph += ' ' + i;
                inputContainer.innerHTML += '<div><input type="number" placeholder="'+ph+'" class="mb-1" onblur="validateField(this)" required><div class="error-msg" data-i18n="error_msg" style="display:none">'+dict[currentLang].error_msg+'</div></div>';
            }
        } else container.classList.add('hidden');
    }

    function validatePassport() {
        var input = document.getElementById('passportExpiry');
        if(!input || !input.value) return;
        var parts = input.value.split('-');
        if(parts.length === 3) {
             var d = new Date(parts[0], parts[1]-1, parts[2]);
             var diffMonths = (d - new Date()) / (1000 * 60 * 60 * 24 * 30.44);
             var alert = document.getElementById('passportAlert');
             if(alert) {
                 if (diffMonths < 9) alert.classList.remove('hidden'); else alert.classList.add('hidden');
             }
        }
    }

    function validateHeight() {
        var input = document.getElementById('height');
        var alert = document.getElementById('heightAlert');
        if(input && input.value && parseInt(input.value) < 145 && alert) alert.classList.remove('hidden'); else if(alert) alert.classList.add('hidden');
    }

    function renderFamMembers(index) {
        var countEl = document.getElementById('w'+index+'_famCount');
        if(!countEl) return;
        var countStr = countEl.value;
        var rows = document.getElementById('w'+index+'_famRows');
        var container = document.getElementById('w'+index+'_famDetails');
        if(!rows || !container) return;
        rows.innerHTML = '';
        
        var count = countStr === '13+' ? 13 : parseInt(countStr);
        if (count > 0) {
            container.classList.remove('hidden');
            var roleTxt = currentLang === 'id' ? 'Pilih Peran' : 'Select Role';
            var ageSt = dict[currentLang].opt_age_start;
            var ageLv = dict[currentLang].opt_age_leave;
            var preg = dict[currentLang].opt_preg;
            var memTxt = currentLang === 'id' ? 'Anggota' : 'Member';
            var errMsgTxt = dict[currentLang].error_msg;
            
            var roleOpts = '<option value="">'+roleTxt+'</option>' + roles.map(function(x){ return '<option value="'+x+'">'+dict[currentLang]['opt_role_'+x.toLowerCase()]+'</option>'; }).join('');
            
            var ageOpts = '<option value="">'+dict[currentLang].opt_select+'</option>';
            ageOpts += '<option value="Start from female employer is pregnant">'+preg+'</option>';
            for(var k=0; k<=20; k+=0.5) ageOpts += '<option value="'+k+'">'+k+'</option>';

            for(var i=1; i<=count; i++) {
                rows.innerHTML += '<div class="p-2 border rounded bg-gray-50 member-row"><span class="font-bold member-label-highlight">'+memTxt+' '+i+':</span><select class="w-full mb-1" onchange="handleRoleChange(this)" onblur="validateField(this)">'+roleOpts+'</select><div class="error-msg text-xs mb-2" style="display:none; color:#991b1b; background-color:#fee2e2; padding:2px;">'+errMsgTxt+'</div><div class="flex flex-col gap-2 age-inputs mt-2"><div class="w-full"><label class="text-xs font-bold">'+ageSt+'</label><select class="w-full" onblur="validateField(this)">'+ageOpts+'</select><div class="error-msg text-xs" style="display:none; color:#991b1b; background-color:#fee2e2; padding:2px;">'+errMsgTxt+'</div></div><div class="w-full"><label class="text-xs font-bold">'+ageLv+'</label><select class="w-full" onblur="validateField(this)">'+ageOpts+'</select><div class="error-msg text-xs" style="display:none; color:#991b1b; background-color:#fee2e2; padding:2px;">'+errMsgTxt+'</div></div></div></div>';
            }
        } else container.classList.add('hidden');
    }
    
    var roles = ['Adult','Boy','Girl','Twins','Triplets','Grandpa','Grandma'];

    window.handleRoleChange = function(select) {
        var ageInputsDiv = select.parentElement.querySelector('.age-inputs');
        var role = select.value;
        if(role === 'Adult') {
            ageInputsDiv.classList.add('hidden');
        } else {
            ageInputsDiv.classList.remove('hidden');
            var selects = ageInputsDiv.querySelectorAll('select');
            var opts = '<option value="">'+dict[currentLang].opt_select+'</option>';
            if(role === 'Grandpa' || role === 'Grandma') {
                for(var k=60; k<=110; k++) opts += '<option value="'+k+'">'+k+'</option>';
            } else {
                opts += '<option value="Start from female employer is pregnant">'+dict[currentLang].opt_preg+'</option>';
                for(var k=0; k<=20; k+=0.5) opts += '<option value="'+k+'">'+k+'</option>';
            }
            selects.forEach(function(s){ s.innerHTML = opts; });
        }
    }

    // --- 4. NAVIGATION & GENERATORS ---

    function renderDynamicSections() {
        var sc = document.getElementById('skillsContainer');
        if(sc) sc.innerHTML = [
            {id: "newborn", key: "skill_newborn"}, {id: "children", key: "skill_children"}, {id: "elderly", key: "skill_elderly"}, {id: "disabled", key: "skill_disabled"}, {id: "pets", key: "skill_pets"}, {id: "cook", key: "skill_cook"}
        ].map(function(s){ return '<div class="question-block"><label class="question-label" data-i18n="'+s.key+'"></label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="'+s.id+'" value="Yes" onclick="singleSelect(this, \''+s.id+'\')"> <span data-i18n="yes_willing">Yes, willing</span></label><label class="checkbox-option"><input type="checkbox" name="'+s.id+'" value="No" onclick="singleSelect(this, \''+s.id+'\')"> <span data-i18n="no">No</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>'; }).join('');

        var fqc = document.getElementById('finalQuestionsContainer');
        if(fqc) fqc.innerHTML = [
            {id: "likeCooking", key: "q_like_cooking", yKey: "q_like_cooking_yes"}, {id: "learnYoutube", key: "q_learn_yt", yKey: "q_learn_yt_yes"}, {id: "cookConfident", key: "q_confident", yKey: "q_confident_yes"}, {id: "singSong", key: "q_sing", yKey: "q_sing_yes"}, {id: "tutor", key: "q_tutor", yKey: "q_tutor_yes"},
        ].map(function(q){ return '<div class="question-block"><label class="question-label" data-i18n="'+q.key+'"></label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="'+q.id+'" value="Yes" onclick="singleSelect(this, \''+q.id+'\')"> <span data-i18n="'+q.yKey+'"></span></label><label class="checkbox-option"><input type="checkbox" name="'+q.id+'" value="No" onclick="singleSelect(this, \''+q.id+'\')"> <span data-i18n="no">No</span></label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>'; }).join('');

        var ync = document.getElementById('yesNoContainer');
        if(ync) ync.innerHTML = [
            {id: "afraidDog", key: "q_dog", yKey: "q_afraid_yes", alert: false}, {id: "afraidCat", key: "q_cat", yKey: "q_afraid_yes", alert: false}, {id: "tattoos", key: "q_tattoo", yKey: "q_tattoo_yes", alert: true, alertMsgKey: "tattoo_msg"}, {id: "smokeDrink", key: "q_smoke", yKey: "q_tattoo_yes", alert: false}, {id: "allergies", key: "q_allergy", yKey: "q_tattoo_yes", alert: false}, {id: "chronic", key: "q_chronic", yKey: "q_tattoo_yes", alert: false}, {id: "consent", key: "q_consent", yKey: "q_consent_yes", alert: false, confirm: true}, {id: "fingers", key: "q_fingers", yKey: "q_fingers_yes", noKey: "q_fingers_no", alert: false}, {id: "confirm", key: "q_confirm", yKey: "q_confirm_yes", noKey: "q_confirm_no", alert: false}
        ].map(function(q){ return '<div class="question-block"><label class="question-label" data-i18n="'+q.key+'"></label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="'+q.id+'" value="Yes" onclick="singleSelect(this, \''+q.id+'\'); '+(q.alert ? 'toggleTattooAlert(true)' : '')+'"> <span data-i18n="'+q.yKey+'"></span></label><label class="checkbox-option"><input type="checkbox" name="'+q.id+'" value="No" onclick="singleSelect(this, \''+q.id+'\'); '+(q.alert ? 'toggleTattooAlert(false)' : '')+'"> <span data-i18n="'+(q.noKey || 'no')+'">No</span></label></div>'+(q.alert ? '<div id="tattooAlert" class="alert-box hidden" data-i18n="'+q.alertMsgKey+'"></div>' : '')+'<div class="error-msg" data-i18n="error_msg">Answer This Question</div></div>'; }).join('');
    }

    function createWorkPage(index) {
        var div = document.createElement('div');
        div.id = 'pageWork' + index;
        div.className = 'page-section hidden';
        var titleKey = index === 1 ? 'work_latest_title' : 'work_other_title';
        var titleText = index === 1 ? '' : ' (' + index + ')';
        var noOptionKey = 'work_more_no_' + index;

        var html = '';
        html += '<h2 class="text-xl font-bold mb-5 border-b-2 border-blue-500 pb-2 highlight-header"><span data-i18n="'+titleKey+'"></span>'+titleText+'</h2>';
        
        // Country
        html += '<div class="question-block"><label class="question-label" data-i18n="work_country"></label><input type="text" id="w'+index+'_country" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Employer Nationality - Separated block
        html += '<div class="question-block"><label class="question-label" data-i18n="work_emp_nat"></label><div class="checkbox-group" onfocusout="validateGroup(this)">';
        html += ['Local people', 'Foreigner', 'Chinese', 'Hong Kong people', 'Asian'].map(function(o){ return '<label class="checkbox-option"><input type="radio" name="w'+index+'_emp_nat" value="'+o+'"> '+o+'</label>'; }).join('');
        html += '</div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Start Date
        html += '<div class="question-block"><label class="question-label" data-i18n="work_start"></label><div class="flex gap-2"><select id="w'+index+'_startMonth" class="w-1/2 dynamic-select" onblur="validateField(this)"></select><select id="w'+index+'_startYear" class="w-1/2 dynamic-select" onblur="validateField(this)"></select></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // End Date
        html += '<div class="question-block"><label class="question-label" data-i18n="work_end"></label><div class="flex gap-2"><select id="w'+index+'_endMonth" class="w-1/2 dynamic-select" onblur="validateField(this)"></select><select id="w'+index+'_endYear" class="w-1/2 dynamic-select" onblur="validateField(this)"></select></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Size
        html += '<div class="question-block"><label class="question-label" data-i18n="work_size"></label><input type="number" id="w'+index+'_houseSize" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Fam Count
        html += '<div class="question-block"><label class="question-label" data-i18n="work_fam_count"></label><select id="w'+index+'_famCount" onchange="renderFamMembers('+index+'); validateField(this)" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg"></div></div>';
        html += '<div id="w'+index+'_famDetails" class="question-block hidden"><label class="question-label" data-i18n="work_fam_age"></label><div id="w'+index+'_famRows" class="flex flex-col gap-3"></div></div>';
        
        // Helpers
        html += '<div class="question-block"><label class="question-label" data-i18n="work_helpers"></label><select id="w'+index+'_helpers" onblur="validateField(this)"></select><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Status
        html += '<div class="question-block"><label class="question-label" data-i18n="work_status"></label><div class="checkbox-group" onfocusout="validateGroup(this)">';
        html += '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_status" value="Finished contract" onclick="singleSelect(this, \'w'+index+'_status\')"> <span data-i18n="hk_finish"></span></label>';
        html += '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_status" value="Employer terminated me already" onclick="singleSelect(this, \'w'+index+'_status\')"> <span data-i18n="hk_terminated"></span></label>';
        html += '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_status" value="I resigned already" onclick="singleSelect(this, \'w'+index+'_status\')"> <span data-i18n="work_status_resigned"></span></label>';
        html += '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_status" value="Not contract and can leave anytime" onclick="singleSelect(this, \'w'+index+'_status\')"> <span data-i18n="work_status_nocontract"></span></label></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Reason
        html += '<div class="question-block"><label class="question-label" data-i18n="work_reason"></label><textarea id="w'+index+'_reason" class="expandable" rows="3" onblur="validateField(this)"></textarea><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Disabled - Added .error-msg divs for dynamic inputs
        html += '<div class="question-block"><label class="question-label" data-i18n="work_dis_q"></label><div class="checkbox-group">';
        html += [{id:'dis_no', val:'No'}, {id:'dis_bed', val:'Bedridden care'}, {id:'dis_dis', val:'Disability care'}, {id:'dis_tra', val:'Tracheostomy care'}, {id:'dis_wheel', val:'Wheelchair'}, {id:'dis_walk', val:'Walking slowly'}, {id:'dis_med', val:'Medication feeding'}, {id:'dis_bath', val:'Bathing assistance'}, {id:'dis_stroke', val:'Stroke'}, {id:'dis_alz', val:'Alzheimer\'s disease'}, {id:'dis_park', val:'Parkinson\'s disease'}]
            .map(function(d){ return '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_disabled" value="'+d.val+'"> <span data-i18n="'+d.id+'">'+d.val+'</span></label>'; }).join('');
        html += '<label class="checkbox-option flex-col !items-start"><div class="flex items-center"><input type="checkbox" name="w'+index+'_disabled" value="Other disabled person (1)" onchange="toggleInput(\'w'+index+'_disabled_other1_input\', this.checked)"> <span data-i18n="dis_other1">Other disabled person (1)</span></div><input type="text" id="w'+index+'_disabled_other1_input" class="hidden w-full p-1 border rounded mt-2 dis-other-input" placeholder="Fill-in details" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></label>';
        html += '<label class="checkbox-option flex-col !items-start"><div class="flex items-center"><input type="checkbox" name="w'+index+'_disabled" value="Other disabled person (2)" onchange="toggleInput(\'w'+index+'_disabled_other2_input\', this.checked)"> <span data-i18n="dis_other2">Other disabled person (2)</span></div><input type="text" id="w'+index+'_disabled_other2_input" class="hidden w-full p-1 border rounded mt-2 dis-other-input" placeholder="Fill-in details" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></label></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
                // Pets - Added .error-msg divs for dynamic inputs
        html += '<div class="question-block"><label class="question-label" data-i18n="work_pets"></label><div class="checkbox-group" onfocusout="validateGroup(this)">';
        html += [{id: 'pet_no', val: 'No pets'}, {id: 'pet_s_dog', val: 'Small dog'}, {id: 'pet_m_dog', val: 'Medium dog'}, {id: 'pet_b_dog', val: 'Big dog'}, {id: 'pet_cat', val: 'Cat'}, {id: 'pet_rabbit', val: 'Rabbit'}].map(function(p){ return '<div class="flex items-center gap-2"><input type="checkbox" name="w'+index+'_pets" value="'+p.val+'" class="pet-check" data-pet="'+p.val+'" onchange="togglePetQty(this, \'w'+index+'_'+p.val.split(' ').join('')+'_qty\')"> <span data-i18n="'+p.id+'">'+p.val+'</span><input type="number" id="w'+index+'_'+p.val.split(' ').join('')+'_qty" class="hidden w-24 p-1 border rounded pet-qty" placeholder="Enter quantity" onblur="validateField(this)"></div>'; }).join('');
        // Removed Other pet (1) as per request
        html += '<div class="flex items-center gap-2"><input type="checkbox" name="w'+index+'_pets" value="Other pet (2)" class="pet-check" data-pet="Other pet (2)" onchange="togglePetQty(this, \'w'+index+'_Others2_qty\')"> <span data-i18n="pet_other2">Other pet (2)</span><div id="w'+index+'_Others2_qty" class="hidden flex gap-2 w-full"><input type="text" class="w-full p-1 border rounded pet-other-input" placeholder="Enter pet" onblur="validateField(this)"><input type="number" class="w-20 p-1 border rounded pet-qty" placeholder="Enter quantity" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div></div>';
        html += '<div class="flex items-center gap-2"><input type="checkbox" name="w'+index+'_pets" value="Other pet (3)" class="pet-check" data-pet="Other pet (3)" onchange="togglePetQty(this, \'w'+index+'_Others3_qty\')"> <span data-i18n="pet_other3">Other pet (3)</span><div id="w'+index+'_Others3_qty" class="hidden flex gap-2 w-full"><input type="text" class="w-full p-1 border rounded pet-other-input" placeholder="Enter pet" onblur="validateField(this)"><input type="number" class="w-20 p-1 border rounded pet-qty" placeholder="Enter quantity" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div></div></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Resp - Added .error-msg divs for dynamic inputs
        html += '<div class="question-block"><label class="question-label" data-i18n="work_resp"></label><div class="checkbox-group" onfocusout="validateGroup(this)">';
        html += [{id: 'resp_car', val: 'Car wash'}, {id: 'resp_clean', val: 'House cleaning'}, {id: 'resp_wash', val: 'Hand washing clothes'}, {id: 'resp_market', val: 'I go to supermarket to buy food'}, {id: 'resp_wet_market', val: 'I go to Chinese wet-market to buy food'}, {id: 'resp_room', val: 'I sharing room with other'}, {id: 'resp_cook_c', val: 'Cook Chinese food'}, {id: 'resp_cook_w', val: 'Cook Western food'}]
            .map(function(r){ return '<label class="checkbox-option"><input type="checkbox" name="w'+index+'_resp" value="'+r.val+'"> <span data-i18n="'+r.id+'">'+r.val+'</span></label>'; }).join('');
        html += '<label class="checkbox-option flex-col !items-start"><div class="flex items-center"><input type="checkbox" name="w'+index+'_resp" value="Other" onchange="toggleInput(\'w'+index+'_resp_other_input\', this.checked)"> <span data-i18n="resp_other">Other responsibilities (1)</span></div><input type="text" id="w'+index+'_resp_other_input" class="hidden w-full p-1 border rounded mt-2 resp-other-input" placeholder="Enter Responsibilities" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></label>';
        html += '<label class="checkbox-option flex-col !items-start"><div class="flex items-center"><input type="checkbox" name="w'+index+'_resp" value="Other2" onchange="toggleInput(\'w'+index+'_resp_other2_input\', this.checked)"> <span data-i18n="resp_other2">Other responsibilities (2)</span></div><input type="text" id="w'+index+'_resp_other2_input" class="hidden w-full p-1 border rounded mt-2 resp-other-input" placeholder="Enter Responsibilities" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></label>';
        html += '<label class="checkbox-option flex-col !items-start"><div class="flex items-center"><input type="checkbox" name="w'+index+'_resp" value="Other3" onchange="toggleInput(\'w'+index+'_resp_other3_input\', this.checked)"> <span data-i18n="resp_other3">Other responsibilities (3)</span></div><input type="text" id="w'+index+'_resp_other3_input" class="hidden w-full p-1 border rounded mt-2 resp-other-input" placeholder="Enter Responsibilities" onblur="validateField(this)"><div class="error-msg" data-i18n="error_msg">Answer This Question</div></label></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // More
        html += '<div class="question-block"><label class="question-label" data-i18n="work_more_q"></label><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="checkbox" name="w'+index+'_more" value="Yes" onclick="singleSelect(this, \'w'+index+'_more\')"> <span data-i18n="work_more_yes"></span></label><label class="checkbox-option"><input type="checkbox" name="w'+index+'_more" value="No" onclick="singleSelect(this, \'w'+index+'_more\')"> <span data-i18n="'+noOptionKey+'"></span></label></div><div class="error-msg" data-i18n="error_msg"></div></div>';
        
        // Buttons
        html += '<div class="nav-buttons"><button class="btn-primary btn-prev" onclick="handleWorkPrev('+index+')" data-i18n="btn_prev"></button><button class="btn-primary" onclick="handleWorkNext('+index+')" data-i18n="btn_next"></button></div>';

        div.innerHTML = html;
        document.getElementById('workPagesContainer').appendChild(div);
    }

    function setLanguage(lang) {
        currentLang = lang;
        document.querySelectorAll('.lang-btn').forEach(function(b){ b.classList.remove('active'); });
        document.querySelector('.lang-btn[onclick="setLanguage(\''+lang+'\')"]').classList.add('active');
        document.getElementById('welcomeTitle').textContent = dict[lang].title_text;
        updateUI();
        regenerateAllSelects();
    }

    function updateUI() {
        document.querySelectorAll('[data-i18n]').forEach(function(el){
            var key = el.getAttribute('data-i18n');
            if(dict[currentLang][key]) el.textContent = dict[currentLang][key];
        });
        document.querySelectorAll('.pet-qty').forEach(function(el){ el.placeholder = dict[currentLang].ph_qty; });
        if(document.getElementById('nat_other_input')) document.getElementById('nat_other_input').placeholder = dict[currentLang].ph_nat_other;
        if(document.getElementById('rel_other_input')) document.getElementById('rel_other_input').placeholder = dict[currentLang].ph_rel_other;
        if(document.getElementById('skill_other_input')) document.getElementById('skill_other_input').placeholder = dict[currentLang].ph_skill_other;
        if(document.getElementById('otherCountryInput')) document.getElementById('otherCountryInput').placeholder = dict[currentLang].ph_cnt_other;
        
        document.querySelectorAll('.resp-other-input').forEach(function(el){ el.placeholder = dict[currentLang].ph_resp; });
        document.querySelectorAll('.pet-other-input').forEach(function(el){ el.placeholder = dict[currentLang].ph_pet; });
        for(var i=1; i<=MAX_JOBS; i++) {
             var d1 = document.getElementById('w'+i+'_disabled_other1_input');
             var d2 = document.getElementById('w'+i+'_disabled_other2_input');
             if(d1) d1.placeholder = dict[currentLang].ph_dis_other1;
             if(d2) d2.placeholder = dict[currentLang].ph_dis_other2;
        }

        var prefix = currentLang === 'id' ? 'Contoh' : 'e.g.';
        ['whatsapp_code', 'referrerPhone_code'].forEach(function(id){
            var el = document.getElementById(id);
            if(el) el.placeholder = prefix + " +852"; 
        });
        var homeCode = document.getElementById('homePhone_code');
        if(homeCode) homeCode.placeholder = currentLang === 'id' ? "Contoh +62" : "e.g. +63";

         ['whatsapp_num', 'homePhone_num', 'referrerPhone_num'].forEach(function(id){
            var el = document.getElementById(id);
            if(el) el.placeholder = prefix + " 96111003"; 
        });
    }

    function regenerateAllSelects() {
        generateSiblingSelects();
        generateFamilySelects();
        generateCountryExpSelects(); 
        for(var i=1; i<=MAX_JOBS; i++) {
            var p = document.getElementById('pageWork'+i);
            if(p) updateWorkPageSelects(i);
        }
        var hkSel = document.getElementById('hkExperienceYears');
        if(hkSel) {
            var val = hkSel.value;
            hkSel.innerHTML = '<option value="0">'+dict[currentLang].opt_never_hk+'</option>';
            hkSel.innerHTML += '<option value="1">'+dict[currentLang].opt_1_year+'</option>';
            for(var i=2; i<=20; i++) hkSel.innerHTML += '<option value="'+i+'">'+i+'</option>';
            hkSel.innerHTML += '<option value="21+">21+</option>';
            hkSel.value = val;
        }
    }

    function generateCountryExpSelects() {
        var container = document.getElementById('otherCountryExpContainer');
        var questions = [{ id: 'cnt_sg', type: 'select' }, { id: 'cnt_tw', type: 'select' }, { id: 'cnt_my', type: 'select' }, { id: 'cnt_me', type: 'select' }, { id: 'cnt_sa', type: 'select' }, { id: 'cnt_id', type: 'select' }, { id: 'cnt_ph', type: 'select' }, { id: 'cnt_other', type: 'input_select' }];
        var savedVals = {};
        questions.forEach(function(q){
            var s = document.getElementById(q.id + '_select');
            if(s) savedVals[q.id + '_select'] = s.value;
            if(q.type === 'input_select') {
                var i = document.getElementById('otherCountryInput');
                if(i) savedVals['otherCountryInput'] = i.value;
            }
        });

        var html = '';
        var opts = '<option value="0">0</option>';
        opts += '<option value="1">'+dict[currentLang].opt_1_year+'</option>';
        for(var i=2; i<=20; i++) opts += '<option value="'+i+'">'+i+'</option>';

        questions.forEach(function(q){
            var labelText = dict[currentLang][q.id] || "Missing";
            html += '<div class="question-block"><label class="question-label">'+labelText+'</label>';
            if(q.type === 'input_select') {
                html += '<div class="flex gap-2"><div class="w-full flex flex-col"><div class="checkbox-group" onfocusout="validateGroup(this)"><label class="checkbox-option"><input type="radio" name="cnt_other_check" value="Yes" onclick="toggleOtherCountryInput(true)"> '+dict[currentLang].cnt_yes_worked+'</label><label class="checkbox-option"><input type="radio" name="cnt_other_check" value="No" onclick="toggleOtherCountryInput(false)"> '+dict[currentLang].cnt_no_worked+'</label></div><div class="error-msg" data-i18n="error_msg">Answer This Question</div></div></div>' + 
                '<div id="cnt_other_details" class="flex gap-2 mt-2 hidden"><input type="text" id="otherCountryInput" class="w-1/2" placeholder="'+dict[currentLang].ph_cnt_other+'" onblur="validateField(this)"><select id="'+q.id+'_select" class="w-1/2" onblur="validateField(this)"><option value="">'+dict[currentLang].opt_select+'</option>'+opts+'</select></div>';
            } else {
                html += '<select id="'+q.id+'_select" onblur="validateField(this)"><option value="">'+dict[currentLang].opt_select+'</option>'+opts+'</select>';
                html += '<div class="error-msg" data-i18n="error_msg">Answer This Question</div>';
            }
            html += '</div>';
        });
        
        container.innerHTML = html;
        questions.forEach(function(q){
            var s = document.getElementById(q.id + '_select');
            if(s && savedVals[q.id + '_select']) s.value = savedVals[q.id + '_select'];
            if(q.type === 'input_select') {
                var i = document.getElementById('otherCountryInput');
                if(i && savedVals['otherCountryInput']) i.value = savedVals['otherCountryInput'];
            }
        });
    }

    function generateSiblingSelects() {
        var sCount = document.getElementById('siblingsCount');
        var sPos = document.getElementById('siblingPos');
        var sCountVal = sCount.value;
        var sPosVal = sPos.value;
        var html = '<option value="">'+dict[currentLang].opt_select+'</option>';
        html += '<option value="0 (Only me)">'+(currentLang==='id'?'0 (Hanya aku)':'0 (Only me)')+'</option>';
        html += '<option value="1">1 '+dict[currentLang].opt_sibling_suf+'</option>';
        for(var i=2; i<=13; i++) html += '<option value="'+i+'">'+i+' '+(i==13?'+':'')+'</option>';
        sCount.innerHTML = html; sCount.value = sCountVal;

        html = '<option value="">'+dict[currentLang].opt_select+'</option>';
        html += currentLang === 'id' ? '<option value="1">Anak pertama</option>' : '<option value="1">Number 1</option>';
        for(var i=2; i<=13; i++) html += '<option value="'+i+'">'+i+' '+(i==13?'+':'')+'</option>';
        sPos.innerHTML = html; sPos.value = sPosVal;
    }

    function generateFamilySelects() {
        var sons = document.getElementById('sonsCount');
        var daughters = document.getElementById('daughtersCount');
        var sV = sons.value; var dV = daughters.value;
        var h = '<option value="">'+dict[currentLang].opt_select+'</option><option value="0">'+dict[currentLang].opt_noson+'</option>';
        h += '<option value="1">'+dict[currentLang].opt_1_son+'</option>';
        for(var i=2; i<=13; i++) h += '<option value="'+i+'">'+i+' '+(i==13?'+':'')+'</option>';
        sons.innerHTML = h; sons.value = sV;
        h = '<option value="">'+dict[currentLang].opt_select+'</option><option value="0">'+dict[currentLang].opt_nodaughter+'</option>';
        h += '<option value="1">'+dict[currentLang].opt_1_daughter+'</option>';
        for(var i=2; i<=13; i++) h += '<option value="'+i+'">'+i+' '+(i==13?'+':'')+'</option>';
        daughters.innerHTML = h; daughters.value = dV;
        document.querySelectorAll('#sonsInputs input, #daughtersInputs input').forEach(function(inp){
             if(currentLang === 'id') {
                 if(inp.placeholder.includes('Son') || inp.placeholder.includes('son')) inp.placeholder = "Umur anak laki-laki";
                 if(inp.placeholder.includes('Daughter') || inp.placeholder.includes('daughter')) inp.placeholder = "Umur anak perempuan";
             }
        });
        var vac = document.getElementById('vacationMonth');
        var vacV = vac.value;
        var sh = document.getElementById('homeWeeks');
        var shV = sh.value;
        var months = currentLang === 'id' ? indoMonths : engMonths;
        h = '<option value="">'+dict[currentLang].opt_select+'</option>';
        months.forEach(function(m){ h += '<option value="'+m+'">'+m+'</option>'; });
        vac.innerHTML = h; vac.value = vacV;
        var w = dict[currentLang].opt_week;
        var ws = dict[currentLang].opt_weeks;
        h = '<option value="">'+dict[currentLang].opt_select+'</option>';
        for(var i=1; i<=13; i++) h += '<option value="'+i+'">'+i+' '+(i>1?ws:w)+(i==13?'+':'')+'</option>';
        sh.innerHTML = h; sh.value = shV;
    }

    function updateWorkPageSelects(i) {
        var months = currentLang === 'id' ? indoMonths : engMonths;
        ['start','end'].forEach(function(type){
            var m = document.getElementById('w'+i+'_'+type+'Month');
            var y = document.getElementById('w'+i+'_'+type+'Year');
            if(!m) return;
            var mV = m.value; var yV = y.value;
            m.innerHTML = '<option value="">'+dict[currentLang].opt_month+'</option>' + months.map(function(x){ return '<option value="'+x+'">'+x+'</option>'; }).join('');
            y.innerHTML = '<option value="">'+dict[currentLang].opt_year+'</option>' + Array.from({length: 31}, function(_, k){ return 2000 + k; }).map(function(x){ return '<option value="'+x+'">'+x+'</option>'; }).join('');
            m.value = mV; y.value = yV;
        });
        var fc = document.getElementById('w'+i+'_famCount');
        if(fc) {
            var v = fc.value;
            var h = '<option value="">'+dict[currentLang].opt_select+'</option><option value="1">'+dict[currentLang].opt_only_emp+'</option>';
            for(var k=2; k<=13; k++) h += '<option value="'+k+'">'+k+' ('+dict[currentLang].opt_emp_plus+' '+(k-1)+')</option>';
            h += '<option value="13+">13+</option>';
            fc.innerHTML = h; fc.value = v;
        }
        var hlp = document.getElementById('w'+i+'_helpers');
        if(hlp) {
            var v = hlp.value;
            var h = '<option value="">'+dict[currentLang].opt_select+'</option><option value="1">'+dict[currentLang].opt_only_me+'</option>';
            for(var k=2; k<=13; k++) h += '<option value="'+k+'">'+k+' ('+dict[currentLang].opt_me_plus+' '+(k-1)+')</option>';
            h += '<option value="13+">13+</option>';
            hlp.innerHTML = h; hlp.value = v;
        }
        var natContainer = document.querySelector('#pageWork'+i+' .checkbox-group'); 
        if(natContainer) {
             var labels = natContainer.querySelectorAll('label');
             var map = {
                 'Local people': dict[currentLang].opt_emp_nat_local,
                 'Foreigner': dict[currentLang].opt_emp_nat_foreigner,
                 'Chinese': dict[currentLang].opt_emp_nat_chinese,
                 'Hong Kong people': dict[currentLang].opt_emp_nat_hk,
                 'Asian': dict[currentLang].opt_emp_nat_asian
             };
             labels.forEach(function(l){
                 var inp = l.querySelector('input');
                 if(inp && map[inp.value]) l.lastChild.textContent = " " + map[inp.value];
             });
        }
        var statusInputs = document.querySelectorAll('input[name="w'+i+'_status"]');
        if(statusInputs.length > 0) {
             statusInputs.forEach(function(inp){
                 var label = inp.parentElement;
                 if(inp.value.includes('resigned') || inp.value === 'I resigned already') label.lastChild.textContent = " " + dict[currentLang].work_status_resigned;
                 if(inp.value.includes('Not contract') || inp.value === 'Not contract and can leave anytime') label.lastChild.textContent = " " + dict[currentLang].work_status_nocontract;
             });
        }
        var famRows = document.getElementById('w'+i+'_famRows');
        if(famRows) {
             var rows = famRows.querySelectorAll('.member-row');
             rows.forEach(function(r){
                 var roleSel = r.querySelector('select');
                 var rV = roleSel.value;
                 roleSel.innerHTML = '<option value="">'+(currentLang==='id'?'Pilih Peran':'Select Role')+'</option>' + 
                     ['Adult','Boy','Girl','Twins','Triplets','Grandpa','Grandma'].map(function(x){ return '<option value="'+x+'">'+dict[currentLang]['opt_role_'+x.toLowerCase()] + '</option>'; }).join('');
                 roleSel.value = rV;
                 var labs = r.querySelectorAll('label');
                 if(labs[0]) labs[0].textContent = dict[currentLang].opt_age_start;
                 if(labs[1]) labs[1].textContent = dict[currentLang].opt_age_leave;
                 var ageSels = r.querySelectorAll('.age-inputs select');
                 ageSels.forEach(function(s){
                     var val = s.value;
                     var opts = '<option value="">'+dict[currentLang].opt_select+'</option>';
                     if(rV === 'Grandpa' || rV === 'Grandma') { for(var k=60; k<=110; k++) opts += '<option value="'+k+'">'+k+'</option>'; } 
                     else { opts += '<option value="Start from female employer is pregnant">'+dict[currentLang].opt_preg+'</option>'; for(var k=0; k<=20; k+=0.5) opts += '<option value="'+k+'">'+k+'</option>'; }
                     s.innerHTML = opts; s.value = val;
                 });
                 var memSpan = r.querySelector('span.font-bold');
                 if(memSpan) {
                     if(memSpan.textContent.includes('Member') || memSpan.textContent.includes('Anggota')) memSpan.textContent = memSpan.textContent.replace(memSpan.textContent.split(' ')[0], dict[currentLang].opt_month === 'Bulan' ? 'Anggota' : 'Member');
                 }
             });
        }
        document.querySelectorAll(`input[name="w${i}_disabled"]`).forEach(function(inp){
             var lbl = inp.parentElement;
             var val = inp.value;
             if(val.includes('Other disabled person (1)')) lbl.lastChild.textContent = " " + dict[currentLang].dis_other1;
             if(val.includes('Other disabled person (2)')) lbl.lastChild.textContent = " " + dict[currentLang].dis_other2;
        });
        var d1 = document.getElementById('w'+i+'_disabled_other1_input');
        var d2 = document.getElementById('w'+i+'_disabled_other2_input');
        if(d1) d1.placeholder = dict[currentLang].ph_dis_other1;
        if(d2) d2.placeholder = dict[currentLang].ph_dis_other2;
    }

    function handleWelcomeNext() {
        if(ENABLE_VALIDATION) {
            var group = document.getElementById('welcome_nat_group');
            validateGroup(group);
            if(group.parentElement.querySelector('.error-msg.visible')) return;

            var applyGroup = document.getElementById('welcome_apply_group');
            validateGroup(applyGroup);
            if(applyGroup.parentElement.querySelector('.error-msg.visible')) return;

            var skillsGroup = document.getElementById('welcome_skills_group');
            validateGroup(skillsGroup);
            if(skillsGroup.parentElement.querySelector('.error-msg.visible')) return;
            
            // Special check for "Other Experience"
            var otherSkill = document.querySelector('input[name="skills"][value="Other"]');
            if(otherSkill && otherSkill.checked) {
                var otherInput = document.getElementById('skill_other_input');
                if(!otherInput.value.trim()) {
                     otherInput.parentElement.querySelector('.error-msg').classList.add('visible');
                     otherInput.classList.add('input-error');
                     return;
                }
            }
        }

        var selected = document.querySelector('input[name="seeker_nationality"]:checked');
        if(!selected) { alert("Please select your nationality"); return; }

        var val = selected.value;
        if(val === 'Filipino') { targetSheetName = 'Phil'; setLanguage('en'); }
        else if (val === 'Indonesian') { targetSheetName = 'Indo'; setLanguage('id'); }
        else { targetSheetName = 'Other'; setLanguage('en'); }
        goToPage('page1');
    }

    function goToPage(pageId) {
        document.querySelectorAll('.page-section').forEach(function(p){ p.classList.add('hidden'); });
        document.getElementById(pageId).classList.remove('hidden');
        window.scrollTo(0,0);
        try { updateUI(); } catch(e) {}
    }

    function nextPage(currentPageNum) {
        if(ENABLE_VALIDATION) {
            var pId = currentPageNum === 1 ? 'page1' : 'page2';
            var p = document.getElementById(pId);
            
            // Validate Groups first
            var groups = p.querySelectorAll('.checkbox-group');
            var hasError = false;
            
            groups.forEach(function(g){ 
                // Special Skip Logic
                if(g.offsetParent === null) return; // Hidden
                validateGroup(g); 
                if(g.parentElement.querySelector('.error-msg.visible')) hasError = true; 
            });

            // Validate Inputs
            var inputs = p.querySelectorAll('input:not([type="checkbox"]):not([type="radio"]), select, textarea');
            inputs.forEach(function(i){ 
                if(i.offsetParent === null) return;
                // Special check for "Other Country"
                if(i.id === 'otherCountryInput') {
                     var otherCntCheck = document.querySelector('input[name="cnt_other_check"]:checked');
                     if(otherCntCheck && (otherCntCheck.value === 'Yes' || otherCntCheck.value.includes('Ya'))) {
                         validateField(i);
                     } else return;
                } else if (i.id === 'sonsInputs' || i.id === 'daughtersInputs') {
                    // Handled by child input checks
                } else if (i.parentElement.id === 'sonsInputs' || i.parentElement.id === 'daughtersInputs') {
                    // Child ages inputs
                    validateField(i);
                } else {
                     validateField(i); 
                }
                
                if(i.classList.contains('input-error')) hasError = true; 
            });
            
            // Specific check for child ages container visibility
            var sonsCount = parseInt(document.getElementById('sonsCount').value);
            if(sonsCount > 0) {
                 var sinps = document.querySelectorAll('#sonsInputs input');
                 sinps.forEach(function(inp){ if(!inp.value) { inp.classList.add('input-error'); hasError = true; }});
            }
            var dCount = parseInt(document.getElementById('daughtersCount').value);
            if(dCount > 0) {
                 var dinps = document.querySelectorAll('#daughtersInputs input');
                 dinps.forEach(function(inp){ if(!inp.value) { inp.classList.add('input-error'); hasError = true; }});
            }

            if(hasError) { alert("Please answer all required questions"); return; }
        }
        
        saveLocal();
        const p1Nat = document.querySelector('input[name="nationality"]:checked');
        if(p1Nat) {
             if(p1Nat.value === 'Filipino') targetSheetName = 'Phil';
             else if(p1Nat.value === 'Indonesian') targetSheetName = 'Indo';
             else targetSheetName = 'Other'; 
        }

        if(currentPageNum === 1) goToPage('page2');
        else if (currentPageNum === 2) goToPage('pageWork1');
    }

    function handleWorkNext(index) {
        if(ENABLE_VALIDATION) {
            var p = document.getElementById('pageWork'+index);
            var hasError = false;

            // Validate Groups (Strict Check for Visible Groups)
            var groups = p.querySelectorAll('.checkbox-group');
            groups.forEach(function(g){ 
                 if(g.offsetParent === null) return;
                 validateGroup(g); 
                 if(g.parentElement.querySelector('.error-msg.visible')) hasError = true; 
            });

            // Validate Inputs & Special Checks
            var inputs = p.querySelectorAll('input:not([type="checkbox"]):not([type="radio"]), select, textarea');
            inputs.forEach(function(i){ 
                if(i.offsetParent === null) return;
                validateField(i); 
                if(i.classList.contains('input-error')) hasError = true; 
            });
            
            // Specific Checks for "Other" checkboxes in Work Page
            var otherChecks = [
                {check: 'w'+index+'_disabled', val: 'Other disabled person (1)', input: 'w'+index+'_disabled_other1_input'},
                {check: 'w'+index+'_disabled', val: 'Other disabled person (2)', input: 'w'+index+'_disabled_other2_input'},
                {check: 'w'+index+'_resp', val: 'Other', input: 'w'+index+'_resp_other_input'},
                {check: 'w'+index+'_resp', val: 'Other2', input: 'w'+index+'_resp_other2_input'},
                {check: 'w'+index+'_resp', val: 'Other3', input: 'w'+index+'_resp_other3_input'}
            ];
            
            otherChecks.forEach(function(obj){
                var cb = document.querySelector('input[name="'+obj.check+'"][value="'+obj.val+'"]');
                if(cb && cb.checked) {
                    var inp = document.getElementById(obj.input);
                    if(inp && !inp.value.trim()) {
                        inp.classList.add('input-error');
                        hasError = true;
                        // Use sibling for error msg
                        var errMsg = inp.nextElementSibling;
                        if(errMsg && errMsg.classList.contains('error-msg')) errMsg.classList.add('visible');
                    }
                }
            });
            
            // Pet Others
            var petOther1 = document.querySelector('input.pet-check[data-pet="Other pet (1)"]');
            if(petOther1 && petOther1.checked) {
                 var c = document.getElementById('w'+index+'_Others_qty');
                 var inps = c.querySelectorAll('input');
                 inps.forEach(function(inp){ if(!inp.value) { inp.classList.add('input-error'); hasError=true; }});
            }

            if(hasError) { alert("Please answer all required questions"); return; }
        }

        saveLocal();
        var more = document.querySelector('input[name="w'+index+'_more"]:checked');
        var val = more ? more.value : '';
        if((val.includes('Yes') || val.includes('Ya')) && index < MAX_JOBS) {
            goToPage('pageWork' + (index+1));
        } else {
            goToPage('pageFinal');
        }
    }

    function handleWorkPrev(index) {
        saveLocal();
        if(index === 1) goToPage('page2');
        else goToPage('pageWork' + (index-1));
    }

    function goBackFromFinal() {
        var targetPage = 1;
        for(var i=1; i<MAX_JOBS; i++) {
             var more = document.querySelector('input[name="w'+i+'_more"]:checked');
             var val = more ? more.value : '';
             if(val.includes('Yes') || val.includes('Ya')) targetPage = i + 1;
             else break;
        }
        goToPage('pageWork' + targetPage);
    }
    
    function handleOverseasNext() {
         document.querySelectorAll('.page-section').forEach(function(p){ p.classList.add('hidden'); });
         document.getElementById('pageSuccess').classList.remove('hidden');
         window.scrollTo(0,0);
    }

    async function submitRegistration() {
        if(ENABLE_VALIDATION) {
            var pf = document.getElementById('pageFinal');
            var groups = pf.querySelectorAll('.checkbox-group');
            var hasError = false;
            groups.forEach(function(g){ 
                if(g.offsetParent === null) return;
                validateGroup(g); 
                if(g.parentElement.querySelector('.error-msg.visible')) hasError = true; 
            });
            
            // Validate Selects in Final Page (e.g. Vacation Month)
            var inputs = pf.querySelectorAll('select, input:not([type="checkbox"]):not([type="radio"])');
            inputs.forEach(function(i){
                if(i.offsetParent === null) return;
                validateField(i);
                if(i.classList.contains('input-error')) hasError = true;
            });
            
            if(hasError) { alert("Please answer all required questions"); return; }
        }
        
        var btn = document.querySelector('.btn-submit');
        btn.innerHTML = 'Submitting...';
        btn.disabled = true;

        var data = saveLocal();
        
        // --- DATA COLLECTION BEFORE SUBMIT ---
        
        // 1. Sons & Daughters Ages (Global)
        var sAges = [];
        document.querySelectorAll('#sonsInputs input').forEach(function(i){ if(i.value) sAges.push(i.value); });
        data.sonsAges = sAges.join(', ');
        
        var dAges = [];
        document.querySelectorAll('#daughtersInputs input').forEach(function(i){ if(i.value) dAges.push(i.value); });
        data.daughtersAges = dAges.join(', ');

        // Loop through all 5 Work Experiences
        for(var k=1; k<=MAX_JOBS; k++) {
            
            // --- FAMILY DATA: Confirmed Separation ---
            var famRows = document.querySelectorAll('#w'+k+'_famRows .member-row');
            var details = [];
            famRows.forEach(function(row){
                 var role = row.querySelector('select').value;
                 var selects = row.querySelectorAll('.age-inputs select');
                 if(selects.length === 2) {
                     var start = selects[0].value;
                     var end = selects[1].value;
                     if(role) details.push(role + ': ' + start + ' to ' + end);
                 }
            });
            
            // ‰∏äËºâÊ¨Ñ‰Ωç: wX_famDetailsStr (Family Ages)
            data['w'+k+'_famDetailsStr'] = details.join(', '); 
            
            // ‰∏äËºâÊ¨Ñ‰Ωç: wX_famCount (Family Count)
            var fcEl = document.getElementById('w'+k+'_famCount');
            data['w'+k+'_famCount'] = fcEl ? fcEl.value : ""; 


            // --- PETS DATA: Final Fix for Quantity Collection ---
            var petList = [];
            
            // A. Ê™¢Êü•Ê®ôÊ∫ñÂØµÁâ© (Small dog, Cat, etc.)
            ['No pets', 'Small dog', 'Medium dog', 'Big dog', 'Cat', 'Rabbit'].forEach(function(pName){
                var cb = document.querySelector('input[name="w'+k+'_pets"][value="'+pName+'"]');
                if(cb && cb.checked) {
                     if(pName === 'No pets') {
                         petList.push(pName);
                     } else {
                         // 1. ÊâæÂá∫Êï∏ÈáèËº∏ÂÖ•Ê°ÜÁöÑÂÆπÂô® ID
                         var qtyId = 'w'+k+'_' + pName.replace(/\s/g, '') + '_qty'; 
                         var qtyContainer = document.getElementById(qtyId);
                         
                         // 2. **‰øÆÊ≠£ÈóúÈçµÔºö** Á≤æÁ¢∫Â∞ãÊâæ type="number" ÁöÑËº∏ÂÖ•Ê°Ü
                         var qtyInput = qtyContainer ? qtyContainer.querySelector('input[type="number"]') : null; 
                         
                         // 3. Áç≤ÂèñÊï∏Èáè 
                         var qty = (qtyInput && qtyInput.value) ? qtyInput.value : '';
                         
                         petList.push(pName + (qty ? ' (' + qty + ')' : ''));
                     }
                }
            });

            // B. Ê™¢Êü•ÂÖ∂‰ªñÂØµÁâ© (Other 2 & 3)
            [2, 3].forEach(function(num){
                var valName = 'Other pet ('+num+')';
                var cb = document.querySelector('input[name="w'+k+'_pets"][value="'+valName+'"]');
                if(cb && cb.checked) {
                     var div = document.getElementById('w'+k+'_Others'+num+'_qty');
                     if(div) {
                         var txtInp = div.querySelector('.pet-other-input');
                         var qtyInp = div.querySelector('.pet-qty'); // Assuming .pet-qty is the number input
                         var t = txtInp ? txtInp.value : '';
                         var q = qtyInp ? qtyInp.value : '';
                         if(t) petList.push(t + (q ? ' (' + q + ')' : ''));
                     }
                }
            });

            // Â∞áÊâÄÊúâÂØµÁâ©Ë≥áÊñôÂêà‰Ωµ‰∏äÂÇ≥Ëá≥ wX_pets_combined
            data['w'+k+'_pets_combined'] = petList.join(', ');
        }

        // --- SHEET NAME LOGIC (‰øùÊåÅ‰∏çËÆä) ---
        var p1Nat = document.querySelector('input[name="nationality"]:checked');
        if(p1Nat) {
             if(p1Nat.value === 'Filipino') targetSheetName = 'Phil';
             else if(p1Nat.value === 'Indonesian') targetSheetName = 'Indo';
             else targetSheetName = 'Other'; 
        }
        
        data.targetSheetName = targetSheetName;
        data.submissionLanguage = currentLang;
        
        // UPDATE WITH YOUR APPS SCRIPT URL HERE
        const scriptURL = "https://script.google.com/macros/s/AKfycbzb0sBBOvornl0hh0Bt_WH_h8Nz9csh9j9_sCvMZdQZO_XduolcQM1Q2FVEC-4Lb6salw/exec"; 
        
        try {
            await fetch(scriptURL, { 
                method: 'POST', 
                mode: 'no-cors',
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify(data) 
            });
            console.log("Submitting to Sheet: " + targetSheetName, data);
            
            var locInput = document.querySelector('input[name="location"]:checked');
            var locVal = locInput ? locInput.value : '';
            var showOverseasMsg = false;
            
            if (currentLang === 'en') {
                if(locVal.includes('Philippines') || locVal.includes('Indonesia') || locVal.includes('other Country')) {
                    showOverseasMsg = true;
                }
            }

            setTimeout(function() {
                if (showOverseasMsg) {
                     document.querySelectorAll('.page-section').forEach(function(p){ p.classList.add('hidden'); });
                     document.getElementById('pageOverseasMsg').classList.remove('hidden');
                     window.scrollTo(0,0);
                } else {
                     document.querySelectorAll('.page-section').forEach(function(p){ p.classList.add('hidden'); });
                     document.getElementById('pageSuccess').classList.remove('hidden');
                }
                
                var sTitle = document.getElementById('successTitle');
                var sMsg = document.getElementById('successMsg');
                var pMsg = document.getElementById('photoMsg');
                var wBtn = document.getElementById('whatsappBtnText');
                var waText = document.getElementById('agencyWaText');
                var d = dict[currentLang];
                
                if(currentLang === 'id') {
                    sTitle.textContent = "Pendaftaran Anda berhasil";
                    sMsg.style.display = 'none';
                    pMsg.innerHTML = d.photo_msg_part1 + '<span class="font-large">' + d.photo_msg_highlight + '</span>' + d.photo_msg_part2;
                    if(wBtn) wBtn.textContent = "Kirim Foto via WhatsApp";
                    if(waText) waText.textContent = d.agency_wa;
                } else {
                    sTitle.textContent = "Registration Submitted!";
                    sMsg.style.display = 'none'; 
                    pMsg.innerHTML = d.photo_msg_part1 + '<span class="font-large">' + d.photo_msg_highlight + '</span>' + d.photo_msg_part2;
                    if(wBtn) wBtn.textContent = "Send Photo on WhatsApp";
                    if(waText) waText.textContent = d.agency_wa;
                }
            }, 1500);
        } catch(e) {
            console.error(e);
            alert("Error submitting form");
            btn.disabled = false;
            btn.innerHTML = "Submit Registration";
        }
    }

    // --- MAIN INIT ---
    window.onload = function() {
        for(var i=1; i<=MAX_JOBS; i++) createWorkPage(i);
        renderDynamicSections(); 
        restoreLocal();
        document.querySelectorAll('.page-section').forEach(function(p){ p.classList.add('hidden'); });
        document.getElementById('pageWelcome').classList.remove('hidden');
        setLanguage('en'); 
    };
</script>

</body>
</html>





